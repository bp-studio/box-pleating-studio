/**
 * shrewd v0.0.11
 * (c) 2019-2021 Mu-Tsun Tsai
 * Released under the MIT License.
 */
!function(t,e){"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?module.exports=e():t.Shrewd=e()}(this,(function(){"use strict";class t{constructor(){this.t=new Set,this.s=t.i++}static h(t){return!(!R.o&&t.l)||(R.u&&!R.$(t)?(console.warn("Inside a renderer function, only the objects owned by the ObservableProperty can be written."),i.p.debug,!1):!(!R.u&&R.g)||(console.warn("Writing into Observables is not allowed inside a ComputedProperty or a ReactiveMethod. For self-correcting behavior, use the renderer option of the ObservableProperty."),i.p.debug,!1))}static m(t){i.p.hook.write(t.s);for(let e of t.t)e.v()}_(t){this.t.add(t)}S(t){this.t.delete(t)}get l(){return this.t.size>0}get j(){return this.t.values()}}t.i=0;class e{read(t){return!1}write(t){}gc(){return[]}sub(t){return!1}}class s{constructor(t){if(this.O=new Set,this.R=t||"undefined"!=typeof window&&window.Vue,!this.R)throw new Error("Global Vue not found; you need to pass a Vue constructor to VueHook.");this.C=new this.R({data:{shrewd:{}}})}read(t){let e=this.C.shrewd[t];return e&&e.__ob__.dep.subs.length>0}write(t){i.p.autoCommit?this.R.set(this.C.shrewd,t,{}):this.O.add(t)}precommit(){for(let t of this.O)this.R.set(this.C.shrewd,t,{});this.O.clear()}gc(){let t=[];for(let e in this.C.shrewd)0==this.C.shrewd[e].__ob__.dep.subs.length&&(this.R.delete(this.C.shrewd,e),t.push(Number(e)));return t}sub(t){return t in this.C.shrewd&&this.C.shrewd[t].__ob__.dep.subs.length>0}}class i{static k(){i.p.hook.precommit&&i.p.hook.precommit(),R.P({g:!0});try{for(let t of i.A)u.G(t)}finally{u.M(),i.A.clear(),R.D();for(let t of i.T)t.V();i.T.clear();for(let t of i.p.hook.gc()){let e=u.W.get(t);e&&u.q(e)}}i.p.hook.postcommit&&i.p.hook.postcommit()}static H(t){i.F.add(t)}static I(){if(!i.K){i.K=!0;for(let t of i.F)i.F.delete(t),t.I();i.K=!1}}static N(){i.k(),i.B=!1}static J(t){i.A.delete(t)}static L(t){t.U||i.A.add(t),i.p.autoCommit&&!i.B&&(Promise.resolve().then(i.N),i.B=!0)}static V(t,e=!1){if(o.X(t,n)){let s=t[n];e?i.T.add(s):s.V()}}}i.p={hook:new e,autoCommit:!0,debug:!0},i.A=new Set,i.T=new Set,i.F=new Set,i.B=!1,i.K=!1;class r{static get(t){if(o.X(t,C))return t[C];{let e=[];return o.Y(t,C,e),e}}static Z(t,e,s,n){if(void 0===e)return"function"==typeof t?r.tt(t):(e,s,i)=>r.Z(e,s,i,t);if("string"==typeof e){let i=s||Object.getOwnPropertyDescriptor(t,e);if(!i)return r.et(x,t,e,void 0,n);if(i.get&&!i.set)return r.et(j,t,e,i,n);if("function"==typeof i.value)return r.et(O,t,e,i,n)}console.warn(`Setup error at ${t.constructor.name}[${e.toString()}]. Decorated member must be one of the following: a field, a readonly get accessor, or a method.`),i.p.debug}static tt(t){var e=new Proxy(t,r.st);return r.it.add(e),e}static et(t,e,s,i,n){var h=new t(e,s,i,n);return r.get(e).push(h.rt),h.nt()}}r.it=new WeakSet,r.st={construct(t,e,s){r.it.has(s)||console.warn(`Class [${s.name}] is derived form @shrewd class [${t.name}], but it is not decorated with @shrewd.`),R.P({o:!0,g:!1,ht:null}),u.ot.push("construct "+t.name);try{let i=Reflect.construct(t,e,s);return i.constructor==t&&new h(i),i}finally{u.ot.pop(),R.D()}}};const n=Symbol("ShrewdObject");class h{constructor(t){this.ct=!1,this.lt=new Map,this.ut=o.Y(t,n,this);let e=Object.getPrototypeOf(this.ut);for(;e;){if(o.X(e,C)){let t=e[C];for(let e of t){let t=new e.at(this.ut,e);this.lt.has(t.ft)?t.V():this.lt.set(t.ft,t)}}e=Object.getPrototypeOf(e)}for(let t of this.lt.values())i.H(t)}V(){if(!this.ct){for(let t of this.lt.values())t.V();this.ct=!0}}dt(t){return this.lt.get(t)}get $t(){let t=[];for(let e of this.lt.values())e instanceof w&&t.push(e);return t}}class o{static X(t,e){return Object.prototype.hasOwnProperty.call(t,e)}static Y(t,e,s){return Object.defineProperty(t,e,{enumerable:!1,writable:!1,configurable:!1,value:s}),t}}class c{get(t,e,s){let i=t[a],r=Reflect.get(t,e);return"function"==typeof r&&(r=this.pt.bind({gt:e,ht:t,bt:r.bind(t),yt:i,wt:s})),"size"==e&&u.vt(t[a]),r}pt(...e){switch(this.gt){case"clear":return void(u.h(this.yt)&&this.ht.size>0&&(this.ht.clear(),t.m(this.yt)));case"delete":return void(u.h(this.yt)&&this.ht.has(e[0])&&(this.ht.delete(e[0]),t.m(this.yt)));case Symbol.iterator:case"entries":case"forEach":case"has":case"keys":case"values":u.vt(this.yt);default:return this.bt(...e)}}}var l;!function(t){t[t._t=0]="$outdated",t[t.St=1]="$updated",t[t.jt=2]="$pending"}(l||(l={}));class u extends t{constructor(t){super(),this.xt=new Set,this.Ot=!1,this.Rt=l._t,this.ct=!1,u.W.set(this.s,this),this.Ct=t}static M(){for(let t of u.kt)t.Rt==l.jt&&t.Pt&&(t.At(),u.kt.delete(t))}static vt(t){if(t instanceof u&&t.ct)return;i.p.hook.read(t.s)&&t instanceof u&&t.Gt();let e=R.ht;e&&e!=t&&!e.ct&&e.xt.add(t)}static q(t){if(t instanceof u&&!t.ct&&t.Mt&&!(t.Mt=t.zt())){i.J(t);for(let e of t.xt)u.q(e)}}static G(t){R.P({o:!1,ht:t}),t.Ot=!0,i.J(t);try{let e=new Set(t.xt);t.Dt(),t.Tt();try{let e=t.Vt();t.Wt(e)}finally{t.qt()}if(t.At(),!t.ct)for(let s of t.xt)e.delete(s),s._(t),t.Pt&&s instanceof u&&s.Gt();for(let t of e)u.q(t)}finally{t.Ot=!1,R.D()}}get U(){return this.Ot}v(){this.Et(),this.Ht(),this.Pt&&i.L(this)}V(){this.ct||(i.J(this),u.W.delete(this.s),u.kt.delete(this),this.ct=!0,this.Ft())}Ft(){this.Dt();for(let t of this.j)t.xt.delete(this),this.S(t);this.At(),this.Ot=!1}Et(){if(this.Rt==l.St){this.Rt=l.jt,u.kt.add(this);for(let t of this.j)t.Et()}}It(){if(this.Ot&&this.Kt(),this.Rt!=l.St){u.ot.push(this);try{for(let t of this.xt)if(t instanceof u){if(t.Ot){u.G(this);break}t.Rt!=l.St&&t.It()}this.Rt==l._t?u.G(this):(u.kt.delete(this),this.At())}finally{u.ot.pop()}}}Kt(){i.p.debug;let t=u.ot.indexOf(this),e=[this,...u.ot.slice(t+1)];e.forEach(t=>t instanceof u&&t.V()),e.push(this);let s=e.map(t=>"string"==typeof t?t:t.Ct).join(" => ");console.warn("Cyclic dependency detected: "+s+"\nAll these reactions will be terminated.")}At(){this.Rt=l.St}Ht(){this.Rt=l._t}get Nt(){return this.Rt}get Pt(){return this.Mt=null!=this.Mt?this.Mt:this.zt()}zt(){if(i.p.hook.sub(this.s))return!0;for(let t of this.j)if(t.Pt)return!0;return!1}Gt(){if(!this.Pt){this.Mt=!0;for(let t of this.xt)t instanceof u&&t.Gt()}}Tt(){}Wt(t){}qt(){}Dt(){for(let t of this.xt)t.S(this);this.xt.clear()}get Bt(){return this.xt.size>0}get Jt(){return this.ct}}u.kt=new Set,u.W=new Map,u.ot=[];const a=Symbol("Observable Helper");class f extends t{constructor(t,e){super(),this.Lt=o.Y(t,a,this),this.Qt=new Proxy(t,e),f.Ut.set(t,this.Qt)}static Xt(t){if(null==t||"object"!=typeof t)return t;if(f.Ut.has(t))return f.Ut.get(t);if(!f.Yt(t))switch(Object.getPrototypeOf(t)){case Array.prototype:t=new v(t).Zt;break;case Set.prototype:t=new g(t).Zt;break;case Map.prototype:t=new b(t).Zt;break;case Object.prototype:t=new p(t).Zt}return t}static te(t){f.Yt(t)&&(t=t[a].Lt),f.Ut.has(t)&&f.Ut.delete(t)}static Yt(t){return null!=t&&"object"==typeof t&&o.X(t,a)}get Zt(){return this.Qt}}f.Ut=new WeakMap;class d extends u{constructor(t,e){super(e.ee+"."+e.se.toString()),this.ie=e,this.re=Object.assign(this.ne,e.p),this.ut=t}get ft(){return this.ie.ee+"."+this.ie.se.toString()}I(){this.It()}get ne(){return{}}zt(){return!!this.re.active||super.zt()}he(){return this.Jt?this.oe():(u.vt(this),this.ce())}}class ${has(t,e){return u.vt(t[a]),Reflect.has(t,e)}get(t,e,s){return u.vt(t[a]),Reflect.get(t,e,s)}set(e,s,i,r){let n=e[a];if(t.h(n)){return i!==Reflect.get(e,s,r)&&(Reflect.set(e,s,f.Xt(i),r),t.m(n)),!0}return!0}deleteProperty(e,s){let i=e[a];if(t.h(i)){let r=Reflect.deleteProperty(e,s);return r&&t.m(i),r}return!0}}class p extends f{constructor(t){for(let e in t)t[e]=f.Xt(t[e]);super(t,p.le)}get ue(){let t=[];for(let e in this.Lt){let s=this.Lt[e];"object"==typeof s&&t.push(s)}return t}}p.le=new $;class g extends f{constructor(t){for(let e of t)t.delete(e),t.add(f.Xt(e));super(t,g.le)}get ue(){let t=[];for(let e of this.Lt)"object"==typeof e&&t.push(e);return t}}g.le=new class extends c{pt(...e){return"add"==this.gt?(u.h(this.yt)&&!this.ht.has(e[0])&&(this.ht.add(f.Xt(e[0])),t.m(this.yt)),this.wt):super.pt.apply(this,e)}};class b extends f{constructor(t){for(let[e,s]of t)t.set(e,f.Xt(s));super(t,b.le)}get ue(){let t=[];for(let[e,s]of this.Lt)"object"==typeof e&&t.push(e),"object"==typeof s&&t.push(s);return t}}b.le=new class extends c{pt(...e){return"set"==this.gt?(u.h(this.yt)&&!this.ht.has(e[0])&&(this.ht.set(e[0],f.Xt(e[1])),t.m(this.yt)),this.wt):super.pt.apply(this,e)}};class y extends d{constructor(t,e){var s,i;super(t,e),this.ae=e.bt,this.re.active&&this.v(),null!==(s=(i=this.re).comparer)&&void 0!==s||(i.comparer=(t,e)=>t===e)}get Vt(){return this.ae.bind(this.ut)}Wt(e){this.re.comparer(this.fe,e)||(this.fe=e,t.m(this)),this.Bt||this.V()}ce(){return this.It(),this.Bt||this.V(),this.fe}oe(){return this.fe}Ft(){f.te(this.fe),super.Ft()}}class w extends d{constructor(t,e){super(t,e),this.de=!1,this.$e=t[e.se],Object.defineProperty(t,e.se,w.pe(e.se)),this.re.renderer||this.At()}static pe(t){return w.ge[t]=w.ge[t]||{get(){return this[n].dt(t).he()},set(e){this[n].dt(t).be(e)}}}static ye(t){if(null!=t&&"object"==typeof t)if(f.Yt(t)){if(!R.$(t[a])){R.ye(t[a]);for(let e of t[a].ue)w.ye(e)}}else if(o.X(t,n))for(let e of t[n].$t)R.$(e)||(R.ye(e),w.ye(e.we))}get ft(){return this.ie.se.toString()}I(){this.de||(this.me(),this.re.renderer?this.It():this.we=this.$e,this.de=!0)}Ht(){this.re.renderer&&super.Ht()}me(){var t,e;null===(e=null===(t=this.re.validator)||void 0===t?void 0:t.apply(this.ut,[this.$e]))||void 0===e||e||(this.$e=void 0),this.$e=f.Xt(this.$e)}ce(){return this.de?(this.re.renderer&&this.It(),this.we):(this.me(),this.$e)}oe(){return this.we}be(e){var s,r;if(this.Jt)this.we=e;else if(t.h(this)&&e!==this.$e){if(null!==(r=null===(s=this.re.validator)||void 0===s?void 0:s.apply(this.ut,[e]))&&void 0!==r&&!r)return i.p.hook.write(this.s);if(this.$e=f.Xt(e),this.re.renderer){this.Tt();try{this.Wt(this.Vt())}finally{this.qt()}}else this.m(this.$e)}}Tt(){R.P({u:!0,ve:new Set}),w.ye(this.$e)}get Vt(){return this.re.renderer.bind(this.ut,this.$e)}Wt(t){t!==this.we&&this.m(f.Xt(t))}qt(){R.D()}m(e){this.we=e,t.m(this)}Ft(){f.te(this.$e),f.te(this.we),delete this.$e,delete this.re,super.Ft()}}w.ge={};class m extends d{constructor(t,e){super(t,e),this.pt=e.bt}get ne(){return{active:!0}}get Vt(){return this.pt.bind(this.ut)}ce(){return()=>(this.It(),this._e)}oe(){return()=>this._e}Wt(e){this._e=e,t.m(this)}Ft(){f.te(this._e),super.Ft()}}class v extends f{constructor(t){for(let e in t)t[e]=f.Xt(t[e]);super(t,v.le)}get ue(){let t=[];for(let e of this.Lt)"object"==typeof e&&t.push(e);return this.Lt}}var _;v.le=new class extends ${get(t,e,s){return("length"==e||"symbol"==typeof e||"number"==typeof e||"string"==typeof e&&e.match(/^\d+$/))&&u.vt(t[a]),Reflect.get(t,e,s)}},function(t){t.shrewd=r.Z,t.symbol=n,t.commit=i.k,t.terminate=i.V,t.hook={default:e,vue:s},t.option=i.p}(_||(_={})),"undefined"!=typeof window&&window.Vue&&(i.p.hook=new s);class S{constructor(t,e,s,i){this.Se=t,this.je=e,this.ie=s,this.xe=i}get Ct(){return this.Se.constructor.name+"."+this.je.toString()}get rt(){return{se:this.je.toString(),ee:this.Se.constructor.name,at:this.Oe,bt:this.pt,p:this.xe}}get pt(){}nt(){}}class j extends S{get Oe(){return y}get pt(){return this.ie.get}nt(){let t=this.Ct,e=this.pt;return this.ie.get=function(){if(o.X(this,n)){return this[n].dt(t).he()}return e.apply(this)},this.ie}}class x extends S{get Oe(){return w}}class O extends S{get Oe(){return m}get pt(){return this.ie.value}nt(){let t=this.Ct,e=this.pt;return delete this.ie.value,delete this.ie.writable,this.ie.get=function(){if(o.X(this,n)){return this[n].dt(t).he()}return e.bind(this)},this.ie}}class R{static P(t){R.Re.push(R.Rt),R.Rt=Object.assign({},R.Rt,t)}static D(){R.Rt=R.Re.pop(),0==R.Re.length&&i.I()}static get g(){return R.Rt.g}static get o(){return R.Rt.o}static get u(){return R.Rt.u}static get ht(){return R.Rt.ht}static $(t){return R.Rt.ve.has(t)}static ye(t){R.Rt.ve.add(t)}}R.Rt={g:!1,o:!1,u:!1,ht:null,ve:new Set},R.Re=[];const C=Symbol("Shrewd Decorators");return _}));
