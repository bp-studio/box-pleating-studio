/**
 * shrewd v0.0.11
 * (c) 2019-2021 Mu-Tsun Tsai
 * Released under the MIT License.
 */
!function(t,e){"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?module.exports=e():t.Shrewd=e()}(this,(function(){"use strict";var t;!function(t){t.array=function(t,e){if(!t!=!e)return!1;if(t==e)return!0;if(t.length!=e.length)return!1;for(let s=0;s<t.length;s++)if(t[s]!==e[s])return!1;return!0},t.unorderedArray=function(t,e){if(!t!=!e)return!1;if(t==e)return!0;if(t.length!=e.length)return!1;for(let s of t)if(!e.includes(s))return!1;return!0}}(t||(t={}));class e{constructor(){this.t=new Set,this.s=e.i++}static h(t){return!(!O.o&&t.l)||(O.u&&!O.$(t)?(console.warn("Inside a renderer function, only the objects owned by the ObservableProperty can be written."),r.p.debug,!1):!(!O.u&&O.g)||(console.warn("Writing into Observables is not allowed inside a ComputedProperty or a ReactiveMethod. For self-correcting behavior, use the renderer option of the ObservableProperty."),r.p.debug,!1))}static m(t){r.p.hook.write(t.s);for(let e of t.t)r.p.debug?e.v(t):e.v()}S(t){this.t.add(t)}_(t){this.t.delete(t)}get l(){return this.t.size>0}get j(){return this.t.values()}}e.i=0;class s{read(t){return!1}write(t){}gc(){return[]}sub(t){return!1}}class i{constructor(t){if(this.k=new Set,this.C=new Set,this.O=t||"undefined"!=typeof window&&window.Vue,!this.O)throw new Error("Global Vue not found; you need to pass a Vue constructor to VueHook.");this.R=new this.O({data:{shrewd:{}}})}read(t){let e=this.R.shrewd[t];return e&&e.__ob__.dep.subs.length>0}write(t){r.p.autoCommit?this.O.set(this.R.shrewd,t,{}):this.k.add(t)}precommit(){for(let t of this.k)this.O.set(this.R.shrewd,t,{});this.k.clear()}gc(){let t=[];for(let e in this.R.shrewd){let s=Number(e);r.p.autoCommit||this.C.has(s)?0==this.R.shrewd[e].__ob__.dep.subs.length&&(r.p.autoCommit||this.C.delete(s),this.O.delete(this.R.shrewd,e),t.push(Number(e))):this.C.add(s)}return t}sub(t){return t in this.R.shrewd&&this.R.shrewd[t].__ob__.dep.subs.length>0}}class r{static P(){r.p.hook.precommit&&r.p.hook.precommit(),O.A({g:!0});try{for(let t of r.G)a.M(t,!0)}finally{a.D(),r.G.clear(),O.T();for(let t of r.q)t.V();r.q.clear(),r.p.debug&&a.W(),r.H()}r.p.hook.postcommit&&r.p.hook.postcommit()}static H(){for(let t of r.F)a.I(t);r.F.clear();for(let t of r.p.hook.gc()){let e=a.K.get(t);e&&a.I(e)}r.N.clear()}static B(t){t instanceof a&&r.F.add(t)}static J(t){r.L.add(t)}static U(){if(!r.X){r.X=!0;for(let t of r.L)r.L.delete(t),t.Y();r.X=!1}}static Y(t){if(t[h]){if(!r.X){r.X=!0;for(let e of t[h].Z())r.L.delete(e),e.Y();r.X=!1}}else n.tt.add(t)}static et(){r.P(),r.st=!1}static it(t){r.G.delete(t)}static rt(t){t.nt||r.G.add(t),r.p.autoCommit&&!r.st&&(Promise.resolve().then(r.et),r.st=!0)}static V(t,e=!1){if(c.ht(t,h)){let s=t[h];e?r.q.add(s):s.V()}}}r.p={hook:new s,autoCommit:!0,debug:!1},r.G=new Set,r.q=new Set,r.L=new Set,r.F=new Set,r.N=new Set,r.st=!1,r.X=!1;class n{static get(t){if(c.ht(t,R))return t[R];{let e=[];return c.ot(t,R,e),e}}static ct(t,e,s,i){if(void 0===e)return"function"==typeof t?n.lt(t):(e,s,i)=>n.ct(e,s,i,t);if("string"==typeof e){let r=s||Object.getOwnPropertyDescriptor(t,e);if(!r)return n.ut(k,t,e,void 0,i);if(r.get&&!r.set)return n.ut(x,t,e,r,i);if("function"==typeof r.value)return n.ut(C,t,e,r,i)}console.warn(`Setup error at ${t.constructor.name}[${e.toString()}]. Decorated member must be one of the following: a field, a readonly get accessor, or a method.`),r.p.debug}static lt(t){var e=new Proxy(t,n.at);return n.ft.add(e),e}static ut(t,e,s,i,r){var h=new t(e,s,i,r);return n.get(e).push(h.dt),h.$t()}}n.ft=new WeakSet,n.at={construct(t,e,s){n.ft.has(s)||console.warn(`Class [${s.name}] is derived form @shrewd class [${t.name}], but it is not decorated with @shrewd.`),O.A({o:!0,g:!1,pt:null}),a.gt.push("construct "+t.name);try{let i=Reflect.construct(t,e,s);return i.constructor==t&&new o(i),n.tt.has(i)&&(n.tt.delete(i),r.Y(i)),i}finally{a.gt.pop(),O.T()}}},n.tt=new Set;const h=Symbol("ShrewdObject");class o{constructor(t){this.bt=!1,this.wt=new Map,this.yt=c.ot(t,h,this);let e=Object.getPrototypeOf(this.yt);for(;e;){if(c.ht(e,R)){let t=e[R];for(let e of t){let t=new e.vt(this.yt,e);this.wt.has(t.St)?t.V():this.wt.set(t.St,t)}}e=Object.getPrototypeOf(e)}for(let t of this.wt.values())r.J(t)}V(){if(!this.bt){for(let t of this.wt.values())t.V();this.bt=!0}}Z(t){return t?this.wt.get(t):this.wt.values()}get _t(){let t=[];for(let e of this.wt.values())e instanceof m&&t.push(e);return t}}class c{static ht(t,e){return Object.prototype.hasOwnProperty.call(t,e)}static ot(t,e,s){return Object.defineProperty(t,e,{enumerable:!1,writable:!1,configurable:!1,value:s}),t}}class l{get(t,e,s){let i=t[f],r=Reflect.get(t,e);return"function"==typeof r&&(r=this.jt.bind({xt:e,pt:t,kt:r.bind(t),Ct:i,Ot:s})),"size"==e&&a.Rt(t[f]),r}jt(...t){switch(this.xt){case"clear":return void(a.h(this.Ct)&&this.pt.size>0&&(this.pt.clear(),e.m(this.Ct)));case"delete":return void(a.h(this.Ct)&&this.pt.has(t[0])&&(this.pt.delete(t[0]),e.m(this.Ct)));case Symbol.iterator:case"entries":case"forEach":case"has":case"keys":case"values":a.Rt(this.Ct);default:return this.kt(...t)}}}var u;!function(t){t[t.Pt=0]="$outdated",t[t.At=1]="$updated",t[t.Gt=2]="$pending"}(u||(u={}));class a extends e{constructor(t){super(),this.Mt=new Set,this.zt=!1,this.Dt=u.Pt,this.bt=!1,this.trigger=new Set,a.K.set(this.s,this),this.Tt=t}static D(){for(let t of a.qt)t.Dt==u.Gt&&t.Vt&&(t.Wt(),a.qt.delete(t))}static W(){for(let t of a.Et)t.trigger.clear();a.Et.clear()}static Ht(t){let e=[t.Tt];for(;t.trigger.size;){let s=t.trigger.values().next().value;if(!(s instanceof a))break;let i=s.Tt;s instanceof $&&(i+="("+$.Ft(s)+")"),e.push(i),t=s}console.log(e)}static Rt(t){if(t instanceof a&&t.bt)return;r.p.hook.read(t.s)&&t instanceof a&&t.It();let e=O.pt;e&&e!=t&&!e.bt&&e.Mt.add(t)}static I(t){if(!r.N.has(t)&&(r.N.add(t),!t.bt&&!(t.Kt=t.Nt())))for(let e of t.Mt)e instanceof a&&a.I(e)}static M(t,e=!1){if(!e||(t.Bt(),!t.bt)){O.A({o:!1,pt:t}),t.zt=!0,r.it(t);try{let e=new Set(t.Mt);t.Jt(),t.Lt();try{let e=t.Qt();t.Ut(e)}finally{t.Xt()}if(t.Wt(),!t.bt)for(let s of t.Mt)e.delete(s),s.S(t),t.Vt&&s instanceof a&&s.It();for(let t of e)r.B(t)}finally{t.zt=!1,O.T()}}}get nt(){return this.zt}v(t){this.Yt(),this.Zt(t),this.Vt&&r.rt(this)}V(){this.bt||(r.it(this),a.K.delete(this.s),a.qt.delete(this),this.bt=!0,this.te())}te(){this.Jt();for(let t of this.j)t.Mt.delete(this),this._(t);this.Wt(),this.zt=!1}Yt(){if(this.Dt==u.At){this.Dt=u.Gt,a.qt.add(this);for(let t of this.j)t.Yt()}}ee(){if(this.zt&&this.se(),this.Dt!=u.At){a.gt.push(this);try{this.Bt(),this.Dt==u.Pt?a.M(this):(a.qt.delete(this),this.Wt())}finally{a.gt.pop()}}}Bt(){for(let t of this.Mt)if(t instanceof a){if(t.zt){a.M(this);break}t.Dt!=u.At&&t.ee()}}se(){r.p.debug;let t=a.gt.indexOf(this),e=[this,...a.gt.slice(t+1)];e.forEach(t=>t instanceof a&&t.V()),e.push(this);let s=e.map(t=>"string"==typeof t?t:t.Tt).join(" => ");console.warn("Cyclic dependency detected: "+s+"\nAll these reactions will be terminated.")}Wt(){this.Dt=u.At}Zt(t){t&&(a.Et.add(this),this.trigger.add(t)),this.Dt=u.Pt}get ie(){return this.Dt}get Vt(){return this.Kt=null!=this.Kt?this.Kt:this.Nt()}Nt(){if(r.p.hook.sub(this.s))return!0;for(let t of this.j)if(t.Vt)return!0;return!1}It(){if(!this.Vt){this.Kt=!0;for(let t of this.Mt)t instanceof a&&t.It()}}Lt(){}Ut(t){}Xt(){}Jt(){for(let t of this.Mt)t._(this);this.Mt.clear()}get re(){return this.Mt.size>0}get ne(){return this.bt}}a.qt=new Set,a.Et=new Set,a.K=new Map,a.gt=[];const f=Symbol("Observable Helper");class d extends e{constructor(t,e){super(),this.he=c.ot(t,f,this),this.oe=new Proxy(t,e),d.ce.set(t,this.oe)}static le(t){if(null==t||"object"!=typeof t)return t;if(d.ce.has(t))return d.ce.get(t);if(!d.ue(t))switch(Object.getPrototypeOf(t)){case Array.prototype:t=new S(t).ae;break;case Set.prototype:t=new b(t).ae;break;case Map.prototype:t=new w(t).ae;break;case Object.prototype:t=new g(t).ae}return t}static fe(t){d.ue(t)&&(t=t[f].he),d.ce.has(t)&&d.ce.delete(t)}static ue(t){return null!=t&&"object"==typeof t&&c.ht(t,f)}get ae(){return this.oe}}d.ce=new WeakMap;class $ extends a{constructor(t,e){super(e.de+"."+e.$e.toString()),this.pe=e,this.ge=Object.assign(this.be,e.p),this.yt=t}static Ft(t){return t.yt.constructor.name}get St(){return this.pe.de+"."+this.pe.$e.toString()}Y(){this.ee()}get be(){return{}}Nt(){return!!this.ge.active||super.Nt()}we(){return this.ne?this.ye():(a.Rt(this),this.me())}}class p{has(t,e){return a.Rt(t[f]),Reflect.has(t,e)}get(t,e,s){return a.Rt(t[f]),Reflect.get(t,e,s)}set(t,s,i,r){let n=t[f];if(e.h(n)){return i!==Reflect.get(t,s,r)&&(Reflect.set(t,s,d.le(i),r),e.m(n)),!0}return!0}deleteProperty(t,s){let i=t[f];if(e.h(i)){let r=Reflect.deleteProperty(t,s);return r&&e.m(i),r}return!0}}class g extends d{constructor(t){for(let e in t)t[e]=d.le(t[e]);super(t,g.ve)}get Se(){let t=[];for(let e in this.he){let s=this.he[e];"object"==typeof s&&t.push(s)}return t}}g.ve=new p;class b extends d{constructor(t){for(let e of t)t.delete(e),t.add(d.le(e));super(t,b.ve)}get Se(){let t=[];for(let e of this.he)"object"==typeof e&&t.push(e);return t}}b.ve=new class extends l{jt(...t){return"add"==this.xt?(a.h(this.Ct)&&!this.pt.has(t[0])&&(this.pt.add(d.le(t[0])),e.m(this.Ct)),this.Ot):super.jt.apply(this,t)}};class w extends d{constructor(t){for(let[e,s]of t)t.set(e,d.le(s));super(t,w.ve)}get Se(){let t=[];for(let[e,s]of this.he)"object"==typeof e&&t.push(e),"object"==typeof s&&t.push(s);return t}}w.ve=new class extends l{jt(...t){return"set"==this.xt?(a.h(this.Ct)&&!this.pt.has(t[0])&&(this.pt.set(t[0],d.le(t[1])),e.m(this.Ct)),this.Ot):super.jt.apply(this,t)}};class y extends ${constructor(t,e){var s,i;super(t,e),this._e=e.kt,this.ge.active&&this.v(),null!==(s=(i=this.ge).comparer)&&void 0!==s||(i.comparer=(t,e)=>t===e)}get Qt(){return this._e.bind(this.yt)}Ut(t){this.ge.comparer.apply(this.yt,[this.je,t,this])||(this.je=t,e.m(this)),this.re||this.V()}me(){return this.ee(),this.re||this.V(),this.je}ye(){return this.je}te(){d.fe(this.je),super.te()}}class m extends ${constructor(t,e){super(t,e),this.xe=!1,this.ke=this.Ce=t[e.$e],Object.defineProperty(t,e.$e,m.Oe(e.$e)),this.ge.renderer||this.Wt()}static Oe(t){return m.Re[t]=m.Re[t]||{get(){return this[h].Z(t).we()},set(e){this[h].Z(t).Pe(e)}}}static Ae(t){if(null!=t&&"object"==typeof t)if(d.ue(t)){if(!O.$(t[f])){O.Ae(t[f]);for(let e of t[f].Se)m.Ae(e)}}else if(c.ht(t,h))for(let e of t[h]._t)O.$(e)||(O.Ae(e),m.Ae(e.ke))}get St(){return this.pe.$e.toString()}Y(){this.xe||(this.Ge(),this.ge.renderer?this.ee():this.ke=this.Ce,this.xe=!0)}Zt(t){this.ge.renderer&&super.Zt(t)}Ge(){var t,e;null===(e=null===(t=this.ge.validator)||void 0===t?void 0:t.apply(this.yt,[this.Ce]))||void 0===e||e||(this.Ce=void 0),this.Ce=d.le(this.Ce)}me(){return this.xe?(this.ge.renderer&&this.ee(),this.ke):(this.Ge(),this.Ce)}ye(){return this.ke}Pe(t){var s,i;if(this.ne)this.ke=t;else if(e.h(this)&&t!==this.Ce){if(null!==(i=null===(s=this.ge.validator)||void 0===s?void 0:s.apply(this.yt,[t]))&&void 0!==i&&!i)return r.p.hook.write(this.s);if(this.Ce=d.le(t),this.ge.renderer){this.Lt();try{this.Ut(this.Qt())}finally{this.Xt()}}else this.m(this.Ce)}}Lt(){O.A({u:!0,Me:new Set}),m.Ae(this.Ce)}get Qt(){return this.ge.renderer.bind(this.yt,this.Ce)}Ut(t){t!==this.ke&&this.m(d.le(t))}Xt(){O.T()}m(t){this.ke=t,e.m(this)}te(){d.fe(this.Ce),d.fe(this.ke),delete this.Ce,delete this.ge,super.te()}}m.Re={};class v extends ${constructor(t,e){super(t,e),this.jt=e.kt}get be(){return{active:!0}}get Qt(){return this.jt.bind(this.yt)}me(){return()=>(this.ee(),this.ze)}ye(){return()=>this.ze}Ut(t){this.ze=t,e.m(this)}te(){d.fe(this.ze),super.te()}}class S extends d{constructor(t){for(let e in t)t[e]=d.le(t[e]);super(t,S.ve)}get Se(){let t=[];for(let e of this.he)"object"==typeof e&&t.push(e);return this.he}}var _;S.ve=new class extends p{get(t,e,s){return("length"==e||"symbol"==typeof e||"number"==typeof e||"string"==typeof e&&e.match(/^\d+$/))&&a.Rt(t[f]),Reflect.get(t,e,s)}},function(e){e.shrewd=n.ct,e.symbol=h,e.commit=r.P,e.terminate=r.V,e.initialize=r.Y,e.hook={default:s,vue:i},e.option=r.p,e.comparer=t,e.debug={trigger(t,e){if(c.ht(t,h)){let s=t[h].Z(e);s?a.Ht(s):console.log("Member not found")}else t instanceof a&&a.Ht(t)}}}(_||(_={})),"undefined"!=typeof window&&window.Vue&&(r.p.hook=new i);class j{constructor(t,e,s,i){this.De=t,this.Te=e,this.pe=s,this.qe=i}get Tt(){return this.De.constructor.name+"."+this.Te.toString()}get dt(){return{$e:this.Te.toString(),de:this.De.constructor.name,vt:this.Ve,kt:this.jt,p:this.qe}}get jt(){}$t(){}}class x extends j{get Ve(){return y}get jt(){return this.pe.get}$t(){let t=this.Tt,e=this.jt;return this.pe.get=function(){if(c.ht(this,h)){return this[h].Z(t).we()}return e.apply(this)},this.pe}}class k extends j{get Ve(){return m}}class C extends j{get Ve(){return v}get jt(){return this.pe.value}$t(){let t=this.Tt,e=this.jt;return delete this.pe.value,delete this.pe.writable,this.pe.get=function(){if(c.ht(this,h)){return this[h].Z(t).we()}return e.bind(this)},this.pe}}class O{static A(t){O.We.push(O.Dt),O.Dt=Object.assign({},O.Dt,t)}static T(){O.Dt=O.We.pop(),0==O.We.length&&r.U()}static get g(){return O.Dt.g}static get o(){return O.Dt.o}static get u(){return O.Dt.u}static get pt(){return O.Dt.pt}static $(t){return O.Dt.Me.has(t)}static Ae(t){O.Dt.Me.add(t)}}O.Dt={g:!1,o:!1,u:!1,pt:null,Me:new Set},O.We=[];const R=Symbol("Shrewd Decorators");return _}));
