/**
 * shrewd v0.0.11
 * (c) 2019-2021 Mu-Tsun Tsai
 * Released under the MIT License.
 */
!function(t,e){"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?module.exports=e():t.Shrewd=e()}(this,(function(){"use strict";var t;!function(t){t.array=function(t,e){if(!t!=!e)return!1;if(t==e)return!0;if(t.length!=e.length)return!1;for(let s=0;s<t.length;s++)if(t[s]!==e[s])return!1;return!0},t.unorderedArray=function(t,e){if(!t!=!e)return!1;if(t==e)return!0;if(t.length!=e.length)return!1;for(let s of t)if(!e.includes(s))return!1;return!0}}(t||(t={}));class e{constructor(){this.t=new Set,this.s=e.i++}static h(t){return!(!k.o&&t.u)||(k.l&&!k.$(t)?(console.warn("Inside a renderer function, only the objects owned by the ObservableProperty can be written."),r.p.debug,!1):!(!k.l&&k.g)||(console.warn("Writing into Observables is not allowed inside a ComputedProperty or a ReactiveMethod. For self-correcting behavior, use the renderer option of the ObservableProperty."),r.p.debug,!1))}static m(t){r.p.hook.write(t.s);for(let e of t.t)r.p.debug?e.v(t):e.v()}_(t){this.t.add(t)}S(t){this.t.delete(t)}get u(){return this.t.size>0}get j(){return this.t.values()}}e.i=0;class s{read(t){return!1}write(t){}gc(){return[]}sub(t){return!1}}class i{constructor(t){if(this.O=new Set,this.R=t||"undefined"!=typeof window&&window.Vue,!this.R)throw new Error("Global Vue not found; you need to pass a Vue constructor to VueHook.");this.k=new this.R({data:{shrewd:{}}})}read(t){let e=this.k.shrewd[t];return e&&e.__ob__.dep.subs.length>0}write(t){r.p.autoCommit?this.R.set(this.k.shrewd,t,{}):this.O.add(t)}precommit(){for(let t of this.O)this.R.set(this.k.shrewd,t,{});this.O.clear()}gc(){let t=[];for(let e in this.k.shrewd)0==this.k.shrewd[e].__ob__.dep.subs.length&&(this.R.delete(this.k.shrewd,e),t.push(Number(e)));return t}sub(t){return t in this.k.shrewd&&this.k.shrewd[t].__ob__.dep.subs.length>0}}class r{static C(){r.p.hook.precommit&&r.p.hook.precommit(),k.P({g:!0});try{for(let t of r.A)a.G(t,!0)}finally{a.M(),r.A.clear(),k.D();for(let t of r.T)t.V();r.T.clear();for(let t of r.p.hook.gc()){let e=a.W.get(t);e&&a.q(e)}}r.p.hook.postcommit&&r.p.hook.postcommit()}static H(t){r.F.add(t)}static I(){if(!r.K){r.K=!0;for(let t of r.F)r.F.delete(t),t.N();r.K=!1}}static N(t){if(t[h]){if(!r.K){r.K=!0;for(let e of t[h].B())r.F.delete(e),e.N();r.K=!1}}else n.J.add(t)}static L(){r.C(),r.U=!1}static X(t){r.A.delete(t)}static Y(t){t.Z||r.A.add(t),r.p.autoCommit&&!r.U&&(Promise.resolve().then(r.L),r.U=!0)}static V(t,e=!1){if(c.tt(t,h)){let s=t[h];e?r.T.add(s):s.V()}}}r.p={hook:new s,autoCommit:!0,debug:!1},r.A=new Set,r.T=new Set,r.F=new Set,r.U=!1,r.K=!1;class n{static get(t){if(c.tt(t,C))return t[C];{let e=[];return c.et(t,C,e),e}}static st(t,e,s,i){if(void 0===e)return"function"==typeof t?n.it(t):(e,s,i)=>n.st(e,s,i,t);if("string"==typeof e){let r=s||Object.getOwnPropertyDescriptor(t,e);if(!r)return n.rt(O,t,e,void 0,i);if(r.get&&!r.set)return n.rt(x,t,e,r,i);if("function"==typeof r.value)return n.rt(R,t,e,r,i)}console.warn(`Setup error at ${t.constructor.name}[${e.toString()}]. Decorated member must be one of the following: a field, a readonly get accessor, or a method.`),r.p.debug}static it(t){var e=new Proxy(t,n.nt);return n.ht.add(e),e}static rt(t,e,s,i,r){var h=new t(e,s,i,r);return n.get(e).push(h.ot),h.ct()}}n.ht=new WeakSet,n.nt={construct(t,e,s){n.ht.has(s)||console.warn(`Class [${s.name}] is derived form @shrewd class [${t.name}], but it is not decorated with @shrewd.`),k.P({o:!0,g:!1,ut:null}),a.lt.push("construct "+t.name);try{let i=Reflect.construct(t,e,s);return i.constructor==t&&new o(i),n.J.has(i)&&(n.J.delete(i),r.N(i)),i}finally{a.lt.pop(),k.D()}}},n.J=new Set;const h=Symbol("ShrewdObject");class o{constructor(t){this.at=!1,this.ft=new Map,this.dt=c.et(t,h,this);let e=Object.getPrototypeOf(this.dt);for(;e;){if(c.tt(e,C)){let t=e[C];for(let e of t){let t=new e.$t(this.dt,e);this.ft.has(t.pt)?t.V():this.ft.set(t.pt,t)}}e=Object.getPrototypeOf(e)}for(let t of this.ft.values())r.H(t)}V(){if(!this.at){for(let t of this.ft.values())t.V();this.at=!0}}B(t){return t?this.ft.get(t):this.ft.values()}get gt(){let t=[];for(let e of this.ft.values())e instanceof m&&t.push(e);return t}}class c{static tt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}static et(t,e,s){return Object.defineProperty(t,e,{enumerable:!1,writable:!1,configurable:!1,value:s}),t}}class u{get(t,e,s){let i=t[f],r=Reflect.get(t,e);return"function"==typeof r&&(r=this.bt.bind({wt:e,ut:t,yt:r.bind(t),vt:i,_t:s})),"size"==e&&a.St(t[f]),r}bt(...t){switch(this.wt){case"clear":return void(a.h(this.vt)&&this.ut.size>0&&(this.ut.clear(),e.m(this.vt)));case"delete":return void(a.h(this.vt)&&this.ut.has(t[0])&&(this.ut.delete(t[0]),e.m(this.vt)));case Symbol.iterator:case"entries":case"forEach":case"has":case"keys":case"values":a.St(this.vt);default:return this.yt(...t)}}}var l;!function(t){t[t.jt=0]="$outdated",t[t.xt=1]="$updated",t[t.Ot=2]="$pending"}(l||(l={}));class a extends e{constructor(t){super(),this.Rt=new Set,this.kt=!1,this.Ct=l.jt,this.at=!1,this.trigger=new Set,a.W.set(this.s,this),this.Pt=t}static M(){for(let t of a.At)t.Ct==l.Ot&&t.Gt&&(t.zt(),a.At.delete(t))}static St(t){if(t instanceof a&&t.at)return;r.p.hook.read(t.s)&&t instanceof a&&t.Mt();let e=k.ut;e&&e!=t&&!e.at&&e.Rt.add(t)}static q(t){if(t instanceof a&&!t.at&&t.Dt&&!(t.Dt=t.Tt())){r.X(t);for(let e of t.Rt)a.q(e)}}static G(t,e=!1){if(!e||(t.Vt(),!t.at)){k.P({o:!1,ut:t}),t.kt=!0,r.X(t);try{let e=new Set(t.Rt);t.Wt(),t.qt();try{let e=t.Et();t.Ht(e)}finally{t.Ft()}if(t.zt(),r.p.debug&&t.trigger.clear(),!t.at)for(let s of t.Rt)e.delete(s),s._(t),t.Gt&&s instanceof a&&s.Mt();for(let t of e)a.q(t)}finally{t.kt=!1,k.D()}}}get Z(){return this.kt}v(t){this.It(),this.Kt(t),this.Gt&&r.Y(this)}V(){this.at||(r.X(this),a.W.delete(this.s),a.At.delete(this),this.at=!0,this.Nt())}Nt(){this.Wt();for(let t of this.j)t.Rt.delete(this),this.S(t);this.zt(),this.kt=!1}It(){if(this.Ct==l.xt){this.Ct=l.Ot,a.At.add(this);for(let t of this.j)t.It()}}Bt(){if(this.kt&&this.Jt(),this.Ct!=l.xt){a.lt.push(this);try{this.Vt(),this.Ct==l.jt?a.G(this):(a.At.delete(this),this.zt())}finally{a.lt.pop()}}}Vt(){for(let t of this.Rt)if(t instanceof a){if(t.kt){a.G(this);break}t.Ct!=l.xt&&t.Bt()}}Jt(){r.p.debug;let t=a.lt.indexOf(this),e=[this,...a.lt.slice(t+1)];e.forEach(t=>t instanceof a&&t.V()),e.push(this);let s=e.map(t=>"string"==typeof t?t:t.Pt).join(" => ");console.warn("Cyclic dependency detected: "+s+"\nAll these reactions will be terminated.")}zt(){this.Ct=l.xt}Kt(t){t&&this.trigger.add(t),this.Ct=l.jt}get Lt(){return this.Ct}get Gt(){return this.Dt=null!=this.Dt?this.Dt:this.Tt()}Tt(){if(r.p.hook.sub(this.s))return!0;for(let t of this.j)if(t.Gt)return!0;return!1}Mt(){if(!this.Gt){this.Dt=!0;for(let t of this.Rt)t instanceof a&&t.Mt()}}qt(){}Ht(t){}Ft(){}Wt(){for(let t of this.Rt)t.S(this);this.Rt.clear()}get Qt(){return this.Rt.size>0}get Ut(){return this.at}}a.At=new Set,a.W=new Map,a.lt=[];const f=Symbol("Observable Helper");class d extends e{constructor(t,e){super(),this.Xt=c.et(t,f,this),this.Yt=new Proxy(t,e),d.Zt.set(t,this.Yt)}static te(t){if(null==t||"object"!=typeof t)return t;if(d.Zt.has(t))return d.Zt.get(t);if(!d.ee(t))switch(Object.getPrototypeOf(t)){case Array.prototype:t=new _(t).se;break;case Set.prototype:t=new b(t).se;break;case Map.prototype:t=new w(t).se;break;case Object.prototype:t=new g(t).se}return t}static ie(t){d.ee(t)&&(t=t[f].Xt),d.Zt.has(t)&&d.Zt.delete(t)}static ee(t){return null!=t&&"object"==typeof t&&c.tt(t,f)}get se(){return this.Yt}}d.Zt=new WeakMap;class $ extends a{constructor(t,e){super(e.re+"."+e.ne.toString()),this.he=e,this.oe=Object.assign(this.ce,e.p),this.dt=t}get pt(){return this.he.re+"."+this.he.ne.toString()}N(){this.Bt()}get ce(){return{}}Tt(){return!!this.oe.active||super.Tt()}ue(){return this.Ut?this.le():(a.St(this),this.ae())}}class p{has(t,e){return a.St(t[f]),Reflect.has(t,e)}get(t,e,s){return a.St(t[f]),Reflect.get(t,e,s)}set(t,s,i,r){let n=t[f];if(e.h(n)){return i!==Reflect.get(t,s,r)&&(Reflect.set(t,s,d.te(i),r),e.m(n)),!0}return!0}deleteProperty(t,s){let i=t[f];if(e.h(i)){let r=Reflect.deleteProperty(t,s);return r&&e.m(i),r}return!0}}class g extends d{constructor(t){for(let e in t)t[e]=d.te(t[e]);super(t,g.fe)}get de(){let t=[];for(let e in this.Xt){let s=this.Xt[e];"object"==typeof s&&t.push(s)}return t}}g.fe=new p;class b extends d{constructor(t){for(let e of t)t.delete(e),t.add(d.te(e));super(t,b.fe)}get de(){let t=[];for(let e of this.Xt)"object"==typeof e&&t.push(e);return t}}b.fe=new class extends u{bt(...t){return"add"==this.wt?(a.h(this.vt)&&!this.ut.has(t[0])&&(this.ut.add(d.te(t[0])),e.m(this.vt)),this._t):super.bt.apply(this,t)}};class w extends d{constructor(t){for(let[e,s]of t)t.set(e,d.te(s));super(t,w.fe)}get de(){let t=[];for(let[e,s]of this.Xt)"object"==typeof e&&t.push(e),"object"==typeof s&&t.push(s);return t}}w.fe=new class extends u{bt(...t){return"set"==this.wt?(a.h(this.vt)&&!this.ut.has(t[0])&&(this.ut.set(t[0],d.te(t[1])),e.m(this.vt)),this._t):super.bt.apply(this,t)}};class y extends ${constructor(t,e){var s,i;super(t,e),this.$e=e.yt,this.oe.active&&this.v(),null!==(s=(i=this.oe).comparer)&&void 0!==s||(i.comparer=(t,e)=>t===e)}get Et(){return this.$e.bind(this.dt)}Ht(t){this.oe.comparer(this.pe,t)||(this.pe=t,e.m(this)),this.Qt||this.V()}ae(){return this.Bt(),this.Qt||this.V(),this.pe}le(){return this.pe}Nt(){d.ie(this.pe),super.Nt()}}class m extends ${constructor(t,e){super(t,e),this.ge=!1,this.be=this.we=t[e.ne],Object.defineProperty(t,e.ne,m.ye(e.ne)),this.oe.renderer||this.zt()}static ye(t){return m.me[t]=m.me[t]||{get(){return this[h].B(t).ue()},set(e){this[h].B(t).ve(e)}}}static _e(t){if(null!=t&&"object"==typeof t)if(d.ee(t)){if(!k.$(t[f])){k._e(t[f]);for(let e of t[f].de)m._e(e)}}else if(c.tt(t,h))for(let e of t[h].gt)k.$(e)||(k._e(e),m._e(e.be))}get pt(){return this.he.ne.toString()}N(){this.ge||(this.Se(),this.oe.renderer?this.Bt():this.be=this.we,this.ge=!0)}Kt(t){this.oe.renderer&&super.Kt(t)}Se(){var t,e;null===(e=null===(t=this.oe.validator)||void 0===t?void 0:t.apply(this.dt,[this.we]))||void 0===e||e||(this.we=void 0),this.we=d.te(this.we)}ae(){return this.ge?(this.oe.renderer&&this.Bt(),this.be):(this.Se(),this.we)}le(){return this.be}ve(t){var s,i;if(this.Ut)this.be=t;else if(e.h(this)&&t!==this.we){if(null!==(i=null===(s=this.oe.validator)||void 0===s?void 0:s.apply(this.dt,[t]))&&void 0!==i&&!i)return r.p.hook.write(this.s);if(this.we=d.te(t),this.oe.renderer){this.qt();try{this.Ht(this.Et())}finally{this.Ft()}}else this.m(this.we)}}qt(){k.P({l:!0,je:new Set}),m._e(this.we)}get Et(){return this.oe.renderer.bind(this.dt,this.we)}Ht(t){t!==this.be&&this.m(d.te(t))}Ft(){k.D()}m(t){this.be=t,e.m(this)}Nt(){d.ie(this.we),d.ie(this.be),delete this.we,delete this.oe,super.Nt()}}m.me={};class v extends ${constructor(t,e){super(t,e),this.bt=e.yt}get ce(){return{active:!0}}get Et(){return this.bt.bind(this.dt)}ae(){return()=>(this.Bt(),this.xe)}le(){return()=>this.xe}Ht(t){this.xe=t,e.m(this)}Nt(){d.ie(this.xe),super.Nt()}}class _ extends d{constructor(t){for(let e in t)t[e]=d.te(t[e]);super(t,_.fe)}get de(){let t=[];for(let e of this.Xt)"object"==typeof e&&t.push(e);return this.Xt}}var S;_.fe=new class extends p{get(t,e,s){return("length"==e||"symbol"==typeof e||"number"==typeof e||"string"==typeof e&&e.match(/^\d+$/))&&a.St(t[f]),Reflect.get(t,e,s)}},function(e){e.shrewd=n.st,e.symbol=h,e.commit=r.C,e.terminate=r.V,e.initialize=r.N,e.hook={default:s,vue:i},e.option=r.p,e.comparer=t}(S||(S={})),"undefined"!=typeof window&&window.Vue&&(r.p.hook=new i);class j{constructor(t,e,s,i){this.Oe=t,this.Re=e,this.he=s,this.ke=i}get Pt(){return this.Oe.constructor.name+"."+this.Re.toString()}get ot(){return{ne:this.Re.toString(),re:this.Oe.constructor.name,$t:this.Ce,yt:this.bt,p:this.ke}}get bt(){}ct(){}}class x extends j{get Ce(){return y}get bt(){return this.he.get}ct(){let t=this.Pt,e=this.bt;return this.he.get=function(){if(c.tt(this,h)){return this[h].B(t).ue()}return e.apply(this)},this.he}}class O extends j{get Ce(){return m}}class R extends j{get Ce(){return v}get bt(){return this.he.value}ct(){let t=this.Pt,e=this.bt;return delete this.he.value,delete this.he.writable,this.he.get=function(){if(c.tt(this,h)){return this[h].B(t).ue()}return e.bind(this)},this.he}}class k{static P(t){k.Pe.push(k.Ct),k.Ct=Object.assign({},k.Ct,t)}static D(){k.Ct=k.Pe.pop(),0==k.Pe.length&&r.I()}static get g(){return k.Ct.g}static get o(){return k.Ct.o}static get l(){return k.Ct.l}static get ut(){return k.Ct.ut}static $(t){return k.Ct.je.has(t)}static _e(t){k.Ct.je.add(t)}}k.Ct={g:!1,o:!1,l:!1,ut:null,je:new Set},k.Pe=[];const C=Symbol("Shrewd Decorators");return S}));
