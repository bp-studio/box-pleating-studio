/**
 * shrewd v0.0.13
 * (c) 2019-2021 Mu-Tsun Tsai
 * Released under the MIT License.
 */
!function(t,e){"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?module.exports=e():t.Shrewd=e()}(this,(function(){"use strict";var t;!function(t){t.array=function(t,e){if(!t!=!e)return!1;if(t==e)return!0;if(t.length!=e.length)return!1;for(let s=0;s<t.length;s++)if(t[s]!==e[s])return!1;return!0},t.unorderedArray=function(t,e){if(!t!=!e)return!1;if(t==e)return!0;if(t.length!=e.length)return!1;for(let s of t)if(!e.includes(s))return!1;return!0}}(t||(t={}));class e{constructor(){this.t=new Set,this.i=e.h++}static o(t){return!(!G.l&&t.u)||(G.$&&!G.g(t)?(console.warn("Inside a renderer function, only the objects owned by the ObservableProperty can be written."),r.p.debug,!1):!(!G.$&&G.m)||(console.warn("Writing into Observables is not allowed inside a ComputedProperty or a ReactiveMethod. For self-correcting behavior, use the renderer option of the ObservableProperty."),r.p.debug,!1))}static v(t){r.p.hook.write(t.i);for(let e of t.t)r.p.debug?e.S(t):e.S()}_(t){this.t.add(t)}j(t){this.t.delete(t)}get u(){return this.t.size>0}get O(){return this.t.values()}}e.h=0;class s{read(t){return!1}write(t){}gc(){return[]}sub(t){return!1}}class i{constructor(t){if(this.k=new Set,this.R=new Set,this.C=t||"undefined"!=typeof window&&window.Vue,!this.C)throw new Error("Global Vue not found; you need to pass a Vue constructor to VueHook.");this.P=new this.C({data:{shrewd:{}}})}read(t){let e=this.P.shrewd[t];return G.m||e||(this.C.set(this.P.shrewd,t,{}),e=this.P.shrewd[t]),e&&e.__ob__.dep.subs.length>0}write(t){r.p.autoCommit||G.m?this.C.set(this.P.shrewd,t,{}):this.k.add(t)}precommit(){for(let t of this.k)this.C.set(this.P.shrewd,t,{});this.k.clear()}gc(){let t=[];for(let e in this.P.shrewd){let s=Number(e);r.p.autoCommit||this.R.has(s)?0==this.P.shrewd[e].__ob__.dep.subs.length&&(r.p.autoCommit||this.R.delete(s),this.C.delete(this.P.shrewd,e),t.push(Number(e))):this.R.add(s)}return t}sub(t){return t in this.P.shrewd&&this.P.shrewd[t].__ob__.dep.subs.length>0}}class r{static A(){r.p.hook.precommit&&r.p.hook.precommit(),A.M(),u.M(),r.p.debug&&d.G(),M.M(),r.p.hook.postcommit&&r.p.hook.postcommit()}}r.p={hook:new s,autoCommit:!0,debug:!1};class n{static get(t){if(c.T(t,T))return t[T];{let e=[];return c.D(t,T,e),e}}static q(t,e,s,i){if(void 0===e)return"function"==typeof t?n.V(t):(e,s,i)=>n.q(e,s,i,t);if("string"==typeof e){let r=s||Object.getOwnPropertyDescriptor(t,e);if(!r)return n.W(R,t,e,void 0,i);if(r.get&&!r.set)return n.W(k,t,e,r,i);if("function"==typeof r.value)return n.W(C,t,e,r,i)}console.warn(`Setup error at ${t.constructor.name}[${e.toString()}]. Decorated member must be one of the following: a field, a readonly get accessor, or a method.`),r.p.debug}static V(t){var e=new Proxy(t,n.H);return n.F.add(e),e}static W(t,e,s,i,r){var h=new t(e,s,i,r);return n.get(e).push(h.K),h.N()}}n.F=new WeakSet,n.H={construct(t,e,s){n.F.has(s)||console.warn(`Class [${s.name}] is derived form @shrewd class [${t.name}], but it is not decorated with @shrewd.`),G.I({l:!0,m:!1,B:null}),d.J.push(`construct ${t.name}`);try{let i=Reflect.construct(t,e,s);return i.constructor==t&&new o(i),n.L.has(i)&&(n.L.delete(i),l.U(i)),i}finally{d.J.pop(),G.X()}}},n.L=new Set;const h=Symbol("ShrewdObject");class o{constructor(t){this.Y=!1,this.Z=new Map,this.tt=c.D(t,h,this);let e=Object.getPrototypeOf(this.tt);for(;e;){if(c.T(e,T)){let t=e[T];for(let e of t){let t=new e.et(this.tt,e);this.Z.has(t.st)?t.it():this.Z.set(t.st,t)}}e=Object.getPrototypeOf(e)}for(let t of this.Z.values())l.rt(t)}it(){if(!this.Y){for(let t of this.Z.values())t.it();delete this.tt,this.Y=!0}}nt(t){return t?this.Z.get(t):this.Z.values()}get ht(){let t=[];for(let e of this.Z.values())e instanceof S&&t.push(e);return t}}class c{static T(t,e){return Object.prototype.hasOwnProperty.call(t,e)}static D(t,e,s){return Object.defineProperty(t,e,{enumerable:!1,writable:!1,configurable:!1,value:s}),t}}class a{get(t,e,s){let i=t[$],r=Reflect.get(t,e);return"function"==typeof r&&(r=this.ot.bind({ct:e,B:t,at:r.bind(t),lt:i,ut:s})),"size"==e&&d.ft(t[$]),r}ot(...t){switch(this.ct){case"clear":return void(d.o(this.lt)&&this.B.size>0&&(this.B.clear(),e.v(this.lt)));case"delete":return void(d.o(this.lt)&&this.B.has(t[0])&&(this.B.delete(t[0]),e.v(this.lt)));case Symbol.iterator:case"entries":case"forEach":case"has":case"keys":case"values":d.ft(this.lt);default:return this.at(...t)}}}class l{static rt(t){l.k.add(t)}static M(){if(!l.dt){l.dt=!0;for(let t of l.k)l.k.delete(t),t.U();l.dt=!1}}static U(t){if(t[h]){if(!l.dt){l.dt=!0;for(let e of t[h].nt())l.k.delete(e),e.U();l.dt=!1}}else n.L.add(t)}}l.k=new Set,l.dt=!1;class u{static M(){for(let t of u.k)t.it();u.k.clear()}static it(t,e=!1){if(t instanceof Object&&c.T(t,h)){let s=t[h];e?u.k.add(s):s.it()}}}var f;u.k=new Set,function(t){t[t.$t=0]="$outdated",t[t.gt=1]="$updated",t[t.bt=2]="$pending"}(f||(f={}));class d extends e{constructor(t){super(),this.wt=[],this.yt=!1,this.vt=f.$t,this.Y=!1,this.St=!1,this._t=!0,this.trigger=new Set,d.jt.set(this.i,this),this.Ot=t}static xt(){for(let t of d.kt)t.vt==f.bt&&t.Rt&&(t.Ct(),d.kt.delete(t))}static G(){for(let t of d.Pt)t.trigger.clear();d.Pt.clear()}static At(t){let e=[t.Ot];for(;t.trigger.size;){let s=t.trigger.values().next().value;if(!(s instanceof d))break;let i=s.Ot;s instanceof p&&(i+="("+p.Mt(s)+")"),e.push(i),t=s}console.log(e)}static ft(t){if(t instanceof d&&t.Y)return;r.p.hook.read(t.i)&&t instanceof d&&t.Gt();let e=G.B;!e||e==t||e.Y||e.St&&!e._t||e.wt.push(t)}static Tt(t){if(M.Dt(t)&&!t.Y&&!(t.qt=t.zt()))for(let e of t.wt)e instanceof d&&d.Tt(e)}get Vt(){return!!this.yt}Wt(){G.I({l:!1,B:this}),this.yt=!0,A.Et(this);try{let t;this.St||(t=this.wt,this.Ht()),this.Ft();try{let t=this.Kt();this.Nt(t)}finally{this.It()}if(this.Ct(),this.St){if(this._t){for(let t of this.wt)t._(this),this.Rt&&t instanceof d&&t.Gt();this._t=!1}}else{let e={};if(!this.Y)for(let t of this.wt)e[t.i]=!0,t._(this),this.Rt&&t instanceof d&&t.Gt();for(let s of t)s.i in e||M.rt(s)}}finally{this.yt=!1,G.X()}}S(t){this.Bt(),this.Jt(t),this.Rt&&A.rt(this)}it(t=!1){if(!this.Y&&(A.Et(this),d.jt.delete(this.i),d.kt.delete(this),this.Lt(),this.Y=!0,this.Ht(),t))for(let t of this.O){let e=t.wt.indexOf(this),s=t.wt.pop();s!=this&&(t.wt[e]=s),this.j(t)}}Lt(){this.Ct(),this.yt=!1}Bt(){if(this.vt==f.gt){this.vt=f.bt,d.kt.add(this);for(let t of this.O)t.Bt()}}Qt(){if(this.yt&&this.Ut(),this.vt!=f.gt){d.J.push(this);try{this.Xt(),this.vt==f.$t?this.Wt():(d.kt.delete(this),this.Ct())}finally{d.J.pop()}}}Xt(){for(let t of this.wt)if(t instanceof d){if(t.yt){this.Wt();break}t.vt!=f.gt&&t.Qt()}}Ut(){r.p.debug;let t=d.J.indexOf(this),e=[this,...d.J.slice(t+1)];e.forEach((t=>t instanceof d&&t.it(!0))),e.push(this);let s=e.map((t=>"string"==typeof t?t:t.Ot)).join(" => ");console.warn("Cyclic dependency detected: "+s+"\nAll these reactions will be terminated.")}Ct(){this.vt=f.gt}Jt(t){t&&(d.Pt.add(this),this.trigger.add(t)),this.vt=f.$t}get Yt(){return this.vt}get Rt(){return this.qt=null!=this.qt?this.qt:this.zt()}zt(){if(r.p.hook.sub(this.i))return!0;for(let t of this.O)if(t.Rt)return!0;return!1}Gt(){if(!this.Rt){this.qt=!0;for(let t of this.wt)t instanceof d&&t.Gt()}}Ft(){}Nt(t){}It(){}Ht(){for(let t of this.wt)t.j(this);this.wt=[]}get Zt(){return this.wt.length>0}get te(){return this.Y}}d.kt=new Set,d.Pt=new Set,d.jt=new Map,d.J=[];const $=Symbol("Observable Helper");class g extends e{constructor(t,e){super(),this.ee=c.D(t,$,this),this.se=new Proxy(t,e),g.ie.set(t,this.se)}static re(t){if(!(t instanceof Object))return t;if(g.ie.has(t))return g.ie.get(t);if(!g.ne(t))switch(Object.getPrototypeOf(t)){case Array.prototype:t=new j(t).he;break;case Set.prototype:t=new m(t).he;break;case Map.prototype:t=new y(t).he;break;case Object.prototype:t=new w(t).he}return t}static oe(t){g.ne(t)&&(t=t[$].ee),t instanceof Object&&g.ie.has(t)&&g.ie.delete(t)}static ne(t){return t instanceof Object&&c.T(t,$)}get he(){return this.se}}g.ie=new WeakMap;class p extends d{constructor(t,e){var s,i;super(e.ce+"."+e.ae.toString()),this.le=e,this.ue=Object.assign(this.fe,e.p),this.St=null!==(i=null===(s=e.p)||void 0===s?void 0:s.static)&&void 0!==i&&i,this.tt=t}static Mt(t){return t.tt.constructor.name}get st(){return this.le.ce+"."+this.le.ae.toString()}U(){this.Qt()}get fe(){return{}}zt(){return!!this.ue.active||super.zt()}de(){return this.te?this.$e():(d.ft(this),this.ge())}}class b{has(t,e){return d.ft(t[$]),Reflect.has(t,e)}get(t,e,s){return d.ft(t[$]),Reflect.get(t,e,s)}set(t,s,i,r){let n=t[$];if(e.o(n)){return i!==Reflect.get(t,s,r)&&(Reflect.set(t,s,g.re(i),r),e.v(n)),!0}return!0}deleteProperty(t,s){let i=t[$];if(e.o(i)){let r=Reflect.deleteProperty(t,s);return r&&e.v(i),r}return!0}}class w extends g{constructor(t){for(let e in t)t[e]=g.re(t[e]);super(t,w.pe)}get be(){let t=[];for(let e in this.ee){let s=this.ee[e];"object"==typeof s&&t.push(s)}return t}}w.pe=new b;class m extends g{constructor(t){for(let e of t)t.delete(e),t.add(g.re(e));super(t,m.pe)}get be(){let t=[];for(let e of this.ee)"object"==typeof e&&t.push(e);return t}}m.pe=new class extends a{ot(...t){return"add"==this.ct?(d.o(this.lt)&&!this.B.has(t[0])&&(this.B.add(g.re(t[0])),e.v(this.lt)),this.ut):super.ot.apply(this,t)}};class y extends g{constructor(t){for(let[e,s]of t)t.set(e,g.re(s));super(t,y.pe)}get be(){let t=[];for(let[e,s]of this.ee)"object"==typeof e&&t.push(e),"object"==typeof s&&t.push(s);return t}}y.pe=new class extends a{ot(...t){return"set"==this.ct?(d.o(this.lt)&&!this.B.has(t[0])&&(this.B.set(t[0],g.re(t[1])),e.v(this.lt)),this.ut):super.ot.apply(this,t)}};class v extends p{constructor(t,e){var s,i;super(t,e),this.we=e.at,this.ue.active&&this.S(),null!==(s=(i=this.ue).comparer)&&void 0!==s||(i.comparer=(t,e)=>t===e)}get Kt(){return this.we.bind(this.tt)}Nt(t){this.ue.comparer.apply(this.tt,[this.me,t,this])||(this.me=t,e.v(this)),this.Zt||this.it()}ge(){return this.Qt(),this.Zt||this.it(),this.me}$e(){return this.me}Lt(){g.oe(this.me),super.Lt()}}class S extends p{constructor(t,e){super(t,e),this.ye=!1,this.ve=this.Se=Reflect.get(t,e.ae),Object.defineProperty(t,e.ae,S._e(e.ae)),this.ue.renderer||this.Ct()}static _e(t){return S.je[t]=S.je[t]||{get(){return this[h].nt(t).de()},set(e){this[h].nt(t).Oe(e)}}}static xe(t){if(t instanceof Object)if(g.ne(t)){if(!G.g(t[$])){G.xe(t[$]);for(let e of t[$].be)S.xe(e)}}else if(c.T(t,h))for(let e of t[h].ht)G.g(e)||(G.xe(e),S.xe(e.ve))}get st(){return this.le.ae.toString()}U(){this.ye||(this.ke(),this.ue.renderer?this.Qt():this.ve=this.Se,this.ye=!0)}Jt(t){this.ue.renderer&&super.Jt(t)}ke(){var t,e;null===(e=null===(t=this.ue.validator)||void 0===t?void 0:t.apply(this.tt,[this.Se]))||void 0===e||e||(this.Se=void 0),this.Se=g.re(this.Se)}ge(){return this.ye?(this.ue.renderer&&this.Qt(),this.ve):(this.ke(),this.Se)}$e(){return this.ve}Oe(t){var s,i;if(this.te)this.ve=t;else if(e.o(this)&&t!==this.Se){if(null!==(i=null===(s=this.ue.validator)||void 0===s?void 0:s.apply(this.tt,[t]))&&void 0!==i&&!i)return r.p.hook.write(this.i);if(this.Se=g.re(t),this.ue.renderer){this.Ft();try{this.Nt(this.Kt())}finally{this.It()}}else this.v(this.Se)}}Ft(){G.I({$:!0,Re:new Set}),S.xe(this.Se)}get Kt(){return this.ue.renderer.bind(this.tt,this.Se)}Nt(t){t!==this.ve&&this.v(g.re(t))}It(){G.X()}v(t){this.ve=t,e.v(this)}Lt(){g.oe(this.Se),g.oe(this.ve),delete this.Se,delete this.ue,super.Lt()}}S.je={};class _ extends p{constructor(t,e){super(t,e),this.ot=e.at}get fe(){return{active:!0}}get Kt(){return this.ot.bind(this.tt)}ge(){return()=>(this.Qt(),this.Ce)}$e(){return()=>this.Ce}Nt(t){this.Ce=t,e.v(this)}Lt(){g.oe(this.Ce),super.Lt()}}class j extends g{constructor(t){for(let e in t)t[e]=g.re(t[e]);super(t,j.pe)}get be(){let t=[];for(let e of this.ee)"object"==typeof e&&t.push(e);return this.ee}}var O;j.pe=new class extends b{get(t,e,s){return("length"==e||"symbol"==typeof e||"number"==typeof e||"string"==typeof e&&e.match(/^\d+$/))&&d.ft(t[$]),Reflect.get(t,e,s)}},function(e){e.shrewd=n.q,e.symbol=h,e.commit=r.A,e.terminate=u.it,e.initialize=l.U,e.hook={default:s,vue:i},e.option=r.p,e.comparer=t,e.debug={trigger(t,e){if(t instanceof Object)if(c.T(t,h)){let s=t[h].nt(e);s?d.At(s):console.log("Member not found")}else t instanceof d&&d.At(t)}}}(O||(O={})),"undefined"!=typeof window&&window.Vue&&(r.p.hook=new i);class x{constructor(t,e,s,i){this.Pe=t,this.Ae=e,this.le=s,this.Me=i}get Ot(){return this.Pe.constructor.name+"."+this.Ae.toString()}get K(){return{ae:this.Ae.toString(),ce:this.Pe.constructor.name,et:this.Ge,at:this.ot,p:this.Me}}get ot(){}N(){}}class k extends x{get Ge(){return v}get ot(){return this.le.get}N(){let t=this.Ot,e=this.ot;return this.le.get=function(){if(c.T(this,h)){return this[h].nt(t).de()}return e.apply(this)},this.le}}class R extends x{get Ge(){return S}}class C extends x{get Ge(){return _}get ot(){return this.le.value}N(){let t=this.Ot,e=this.ot;return delete this.le.value,delete this.le.writable,this.le.get=function(){if(c.T(this,h)){return this[h].nt(t).de()}return e.bind(this)},this.le}}class P{static Te(){r.A(),P.De=!1}static N(){r.p.autoCommit&&!P.De&&(P.De=!0,Promise.resolve().then(P.Te))}}P.De=!1;class A{static M(){for(G.I({m:!0});A.k.size>0;)for(let t of A.k)t.Xt(),t.te||t.Wt();d.xt(),G.X()}static Et(t){A.k.delete(t)}static rt(t){t.Vt||A.k.add(t),P.N()}}A.k=new Set;class M{static rt(t){t instanceof d&&M.k.add(t)}static M(){for(let t of M.k)d.Tt(t);M.k.clear();for(let t of r.p.hook.gc()){let e=d.jt.get(t);e&&d.Tt(e)}M.qe.clear()}static Dt(t){return!M.qe.has(t)&&(M.qe.add(t),!0)}}M.k=new Set,M.qe=new Set;class G{static I(t){G.ze.push(G.vt),G.vt=Object.assign({},G.vt,t)}static X(){G.vt=G.ze.pop(),0==G.ze.length&&l.M()}static get m(){return G.vt.m}static get l(){return G.vt.l}static get $(){return G.vt.$}static get B(){return G.vt.B}static g(t){return G.vt.Re.has(t)}static xe(t){G.vt.Re.add(t)}}G.vt={m:!1,l:!1,$:!1,B:null,Re:new Set},G.ze=[];const T=Symbol("Shrewd Decorators");return O}));
