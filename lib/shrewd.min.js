/**
 * shrewd v0.0.13
 * (c) 2019-2021 Mu-Tsun Tsai
 * Released under the MIT License.
 */
!function(t,e){"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?module.exports=e():t.Shrewd=e()}(this,(function(){return(()=>{var t=Object.defineProperty,e={};((e,s)=>{for(var i in(e=>{t(e,"__esModule",{value:!0})})(e),s)t(e,i,{get:s[i],enumerable:!0})})(e,{commit:()=>st,comparer:()=>ot,debug:()=>ct,hook:()=>nt,initialize:()=>rt,option:()=>ht,shrewd:()=>tt,symbol:()=>et,terminate:()=>it});var s,i,r=Symbol("Shrewd Decorators"),n=class{constructor(t,e,s,i){this.t=t,this.i=e,this.h=s,this.o=i}get l(){return this.t.constructor.name+"."+this.i.toString()}get u(){return{$:this.i.toString(),g:this.t.constructor.name,p:this.m,v:this._,S:this.o}}get _(){}j(){}};(i=s||(s={})).array=function(t,e){if(!t!=!e)return!1;if(t==e)return!0;if(t.length!=e.length)return!1;for(let s=0;s<t.length;s++)if(t[s]!==e[s])return!1;return!0},i.unorderedArray=function(t,e){if(!t!=!e)return!1;if(t==e)return!0;if(t.length!=e.length)return!1;for(let s of t)if(!e.includes(s))return!1;return!0};var h=class{static get(t){if(p.O(t,r))return t[r];{let e=[];return p.k(t,r,e),e}}static R(t,e,s,i){if(void 0===e)return"function"==typeof t?h.C(t):(e,s,i)=>h.R(e,s,i,t);if("string"==typeof e){let r=s||Object.getOwnPropertyDescriptor(t,e);if(!r)return h.P(G,t,e,void 0,i);if(r.get&&!r.set)return h.P(M,t,e,r,i);if("function"==typeof r.value)return h.P(T,t,e,r,i)}console.warn(`Setup error at ${t.constructor.name}[${e.toString()}]. Decorated member must be one of the following: a field, a readonly get accessor, or a method.`),C.S.debug}static C(t){var e=new Proxy(t,h.A);return h.M.add(e),e}static P(t,e,s,i,r){var n=new t(e,s,i,r);return h.get(e).push(n.u),n.j()}},o=h;o.M=new WeakSet,o.A={construct(t,e,s){h.M.has(s)||console.warn(`Class [${s.name}] is derived form @shrewd class [${t.name}], but it is not decorated with @shrewd.`),a.G({T:!0,D:!1,q:null}),D.V.push(`construct ${t.name}`);try{let i=Reflect.construct(t,e,s);return i.constructor==t&&new u(i),h.W.has(i)&&(h.W.delete(i),O.H(i)),i}finally{D.V.pop(),a.F()}}},o.W=new Set;var c=class{static G(t){c.K.push(c.N),c.N=Object.assign({},c.N,t)}static F(){c.N=c.K.pop(),0==c.K.length&&O.I()}static get D(){return c.N.D}static get T(){return c.N.T}static get B(){return c.N.B}static get q(){return c.N.q}static J(t){return c.N.L.has(t)}static U(t){c.N.L.add(t)}},a=c;a.N={D:!1,T:!1,B:!1,q:null,L:new Set},a.K=[];var l=Symbol("ShrewdObject"),u=class{constructor(t){this.X=!1,this.Y=new Map,this.Z=p.k(t,l,this);let e=Object.getPrototypeOf(this.Z);for(;e;){if(p.O(e,r)){let t=e[r];for(let e of t){let t=new e.p(this.Z,e);this.Y.has(t.tt)?t.et():this.Y.set(t.tt,t)}}e=Object.getPrototypeOf(e)}for(let t of this.Y.values())O.st(t)}et(){if(!this.X){for(let t of this.Y.values())t.et();delete this.Z,this.X=!0}}it(t){return t?this.Y.get(t):this.Y.values()}get rt(){let t=[];for(let e of this.Y.values())e instanceof U&&t.push(e);return t}},f=class{constructor(){this.nt=new Set,this.ht=f.ot++}static ct(t){return!(!a.T&&t.at)||(a.B&&!a.J(t)?(console.warn("Inside a renderer function, only the objects owned by the ObservableProperty can be written."),C.S.debug,!1):!(!a.B&&a.D)||(console.warn("Writing into Observables is not allowed inside a ComputedProperty or a ReactiveMethod. For self-correcting behavior, use the renderer option of the ObservableProperty."),C.S.debug,!1))}static lt(t){C.S.hook.write(t.ht);for(let e of t.nt)C.S.debug?e.ut(t):e.ut()}ft(t){this.nt.add(t)}dt(t){this.nt.delete(t)}get at(){return this.nt.size>0}get $t(){return this.nt.values()}},d=f;d.ot=0;var $=class{read(t){return!1}write(t){}gc(){return[]}sub(t){return!1}},g=class{constructor(t){if(this.gt=new Set,this.bt=new Set,this.wt=t||"undefined"!=typeof window&&window.Vue,!this.wt)throw new Error("Global Vue not found; you need to pass a Vue constructor to VueHook.");this.yt=new this.wt({data:{shrewd:{}}})}read(t){let e=this.yt.shrewd[t];return a.D||e||(this.wt.set(this.yt.shrewd,t,{}),e=this.yt.shrewd[t]),e&&e.__ob__.dep.subs.length>0}write(t){C.S.autoCommit||a.D?this.wt.set(this.yt.shrewd,t,{}):this.gt.add(t)}precommit(){for(let t of this.gt)this.wt.set(this.yt.shrewd,t,{});this.gt.clear()}gc(){let t=[];for(let e in this.yt.shrewd){let s=Number(e);C.S.autoCommit||this.bt.has(s)?0==this.yt.shrewd[e].__ob__.dep.subs.length&&(C.S.autoCommit||this.bt.delete(s),this.wt.delete(this.yt.shrewd,e),t.push(Number(e))):this.bt.add(s)}return t}sub(t){return t in this.yt.shrewd&&this.yt.shrewd[t].__ob__.dep.subs.length>0}},p=class{static O(t,e){return Object.prototype.hasOwnProperty.call(t,e)}static k(t,e,s){return Object.defineProperty(t,e,{enumerable:!1,writable:!1,configurable:!1,value:s}),t}},b=class{get(t,e,s){let i=t[q],r=Reflect.get(t,e);return"function"==typeof r&&(r=this._.bind({vt:e,q:t,v:r.bind(t),_t:i,St:s})),"size"==e&&D.jt(t[q]),r}_(...t){switch(this.vt){case"clear":return void(D.ct(this._t)&&this.q.size>0&&(this.q.clear(),d.lt(this._t)));case"delete":return void(D.ct(this._t)&&this.q.has(t[0])&&(this.q.delete(t[0]),d.lt(this._t)));case Symbol.iterator:case"entries":case"forEach":case"has":case"keys":case"values":D.jt(this._t);default:return this.v(...t)}}},m=class{static Ot(){C.xt(),m.kt=!1}static j(){C.S.autoCommit&&!m.kt&&(m.kt=!0,Promise.resolve().then(m.Ot))}},w=m;w.kt=!1;var y=class{static I(){for(a.G({D:!0});y.gt.size>0;)for(let t of y.gt)t.Rt(),t.Ct||t.Pt();D.At(),a.F()}static Mt(t){y.gt.delete(t)}static st(t){t.Gt||y.gt.add(t),w.j()}},v=y;v.gt=new Set;var _=class{static st(t){t instanceof D&&_.gt.add(t)}static I(){for(let t of _.gt)D.Tt(t);_.gt.clear();for(let t of C.S.hook.gc()){let e=D.zt.get(t);e&&D.Tt(e)}_.Dt.clear()}static qt(t){return!_.Dt.has(t)&&(_.Dt.add(t),!0)}},S=_;S.gt=new Set,S.Dt=new Set;var j=class{static st(t){j.gt.add(t)}static I(){if(!j.Vt){j.Vt=!0;for(let t of j.gt)j.gt.delete(t),t.H();j.Vt=!1}}static H(t){if(t[l]){if(!j.Vt){j.Vt=!0;for(let e of t[l].it())j.gt.delete(e),e.H();j.Vt=!1}}else o.W.add(t)}},O=j;O.gt=new Set,O.Vt=!1;var x=class{static I(){for(let t of x.gt)t.et();x.gt.clear()}static et(t,e=!1){if(t instanceof Object&&p.O(t,l)){let s=t[l];e?x.gt.add(s):s.et()}}},k=x;k.gt=new Set;var R=class{static xt(){R.S.hook.precommit&&R.S.hook.precommit(),v.I(),k.I(),R.S.debug&&D.Wt(),S.I(),R.S.hook.postcommit&&R.S.hook.postcommit()}},C=R;C.S={hook:new $,autoCommit:!0,debug:!1};var P,A,M=class extends n{get m(){return L}get _(){return this.h.get}j(){let t=this.l,e=this._;return this.h.get=function(){if(p.O(this,l)){return this[l].it(t).Et()}return e.apply(this)},this.h}},G=class extends n{get m(){return U}},T=class extends n{get m(){return X}get _(){return this.h.value}j(){let t=this.l,e=this._;return delete this.h.value,delete this.h.writable,this.h.get=function(){if(p.O(this,l)){return this[l].it(t).Et()}return e.bind(this)},this.h}};(A=P||(P={}))[A.Ht=0]="$outdated",A[A.Ft=1]="$updated",A[A.Kt=2]="$pending";var z=class extends d{constructor(t){super(),this.Nt=[],this.It=!1,this.N=0,this.X=!1,this.Bt=!1,this.Jt=!0,this.trigger=new Set,z.zt.set(this.ht,this),this.l=t}static At(){for(let t of z.Lt)2==t.N&&t.Qt&&(t.Ut(),z.Lt.delete(t))}static Wt(){for(let t of z.Xt)t.trigger.clear();z.Xt.clear()}static Yt(t){let e=[t.l];for(;t.trigger.size;){let s=t.trigger.values().next().value;if(!(s instanceof z))break;let i=s.l;s instanceof E&&(i+="("+E.Zt(s)+")"),e.push(i),t=s}console.log(e)}static jt(t){if(t instanceof z&&t.X)return;C.S.hook.read(t.ht)&&t instanceof z&&t.te();let e=a.q;!e||e==t||e.X||e.Bt&&!e.Jt||e.Nt.push(t)}static Tt(t){if(S.qt(t)&&!t.X&&!(t.ee=t.se()))for(let e of t.Nt)e instanceof z&&z.Tt(e)}get Gt(){return!!this.It}Pt(){a.G({T:!1,q:this}),this.It=!0,v.Mt(this);try{let t;this.Bt||(t=this.Nt,this.ie()),this.re();try{let t=this.ne();this.he(t)}finally{this.oe()}if(this.Ut(),this.Bt){if(this.Jt){for(let t of this.Nt)t.ft(this),this.Qt&&t instanceof z&&t.te();this.Jt=!1}}else{let e={};if(!this.X)for(let t of this.Nt)e[t.ht]=!0,t.ft(this),this.Qt&&t instanceof z&&t.te();for(let s of t)s.ht in e||S.st(s)}}finally{this.It=!1,a.F()}}ut(t){this.ce(),this.ae(t),this.Qt&&v.st(this)}et(t=!1){if(!this.X&&(v.Mt(this),z.zt.delete(this.ht),z.Lt.delete(this),this.le(),this.X=!0,this.ie(),t))for(let t of this.$t){let e=t.Nt.indexOf(this),s=t.Nt.pop();s!=this&&(t.Nt[e]=s),this.dt(t)}}le(){this.Ut(),this.It=!1}ce(){if(1==this.N){this.N=2,z.Lt.add(this);for(let t of this.$t)t.ce()}}ue(){if(this.It&&this.fe(),1!=this.N){z.V.push(this);try{this.Rt(),0==this.N?this.Pt():(z.Lt.delete(this),this.Ut())}finally{z.V.pop()}}}Rt(){for(let t of this.Nt)if(t instanceof z){if(t.It){this.Pt();break}1!=t.N&&t.ue()}}fe(){C.S.debug;let t=z.V.indexOf(this),e=[this,...z.V.slice(t+1)];e.forEach((t=>t instanceof z&&t.et(!0))),e.push(this);let s=e.map((t=>"string"==typeof t?t:t.l)).join(" => ");console.warn("Cyclic dependency detected: "+s+"\nAll these reactions will be terminated.")}Ut(){this.N=1}ae(t){t&&(z.Xt.add(this),this.trigger.add(t)),this.N=0}get de(){return this.N}get Qt(){return this.ee=null!=this.ee?this.ee:this.se()}se(){if(C.S.hook.sub(this.ht))return!0;for(let t of this.$t)if(t.Qt)return!0;return!1}te(){if(!this.Qt){this.ee=!0;for(let t of this.Nt)t instanceof z&&t.te()}}re(){}he(t){}oe(){}ie(){for(let t of this.Nt)t.dt(this);this.Nt=[]}get $e(){return this.Nt.length>0}get Ct(){return this.X}},D=z;D.Lt=new Set,D.Xt=new Set,D.zt=new Map,D.V=[];var q=Symbol("Observable Helper"),V=class extends d{static ge(t){if(!(t instanceof Object))return t;if(V.pe.has(t))return V.pe.get(t);if(!V.be(t))switch(Object.getPrototypeOf(t)){case Array.prototype:t=new Z(t).me;break;case Set.prototype:t=new J(t).me;break;case Map.prototype:t=new I(t).me;break;case Object.prototype:t=new K(t).me}return t}static we(t){V.be(t)&&(t=t[q].ye),t instanceof Object&&V.pe.has(t)&&V.pe.delete(t)}static be(t){return t instanceof Object&&p.O(t,q)}constructor(t,e){super(),this.ye=p.k(t,q,this),this.ve=new Proxy(t,e),V.pe.set(t,this.ve)}get me(){return this.ve}},W=V;W.pe=new WeakMap;var E=class extends D{static Zt(t){return t.Z.constructor.name}constructor(t,e){var s,i;super(e.g+"."+e.$.toString()),this.h=e,this._e=Object.assign(this.Se,e.S),this.Bt=null!=(i=null==(s=e.S)?void 0:s.static)&&i,this.Z=t}get tt(){return this.h.g+"."+this.h.$.toString()}H(){this.ue()}get Se(){return{}}se(){return!!this._e.active||super.se()}Et(){return this.Ct?this.je():(D.jt(this),this.Oe())}},H=class{has(t,e){return D.jt(t[q]),Reflect.has(t,e)}get(t,e,s){return D.jt(t[q]),Reflect.get(t,e,s)}set(t,e,s,i){let r=t[q];if(d.ct(r)){return s!==Reflect.get(t,e,i)&&(Reflect.set(t,e,W.ge(s),i),d.lt(r)),!0}return!0}deleteProperty(t,e){let s=t[q];if(d.ct(s)){let i=Reflect.deleteProperty(t,e);return i&&d.lt(s),i}return!0}},F=class extends W{constructor(t){for(let e in t)t[e]=W.ge(t[e]);super(t,F.xe)}get ke(){let t=[];for(let e in this.ye){let s=this.ye[e];"object"==typeof s&&t.push(s)}return t}},K=F;K.xe=new H;var N=class extends W{constructor(t){for(let[e,s]of t)t.set(e,W.ge(s));super(t,N.xe)}get ke(){let t=[];for(let[e,s]of this.ye)"object"==typeof e&&t.push(e),"object"==typeof s&&t.push(s);return t}},I=N;I.xe=new class extends b{_(...t){return"set"==this.vt?(D.ct(this._t)&&!this.q.has(t[0])&&(this.q.set(t[0],W.ge(t[1])),d.lt(this._t)),this.St):super._.apply(this,t)}};var B=class extends W{constructor(t){for(let e of t)t.delete(e),t.add(W.ge(e));super(t,B.xe)}get ke(){let t=[];for(let e of this.ye)"object"==typeof e&&t.push(e);return t}},J=B;J.xe=new class extends b{_(...t){return"add"==this.vt?(D.ct(this._t)&&!this.q.has(t[0])&&(this.q.add(W.ge(t[0])),d.lt(this._t)),this.St):super._.apply(this,t)}};var L=class extends E{constructor(t,e){var s;super(t,e),this.Re=e.v,this._e.active&&this.ut(),null!=(s=this._e).comparer||(s.comparer=(t,e)=>t===e)}get ne(){return this.Re.bind(this.Z)}he(t){this._e.comparer.apply(this.Z,[this.Ce,t,this])||(this.Ce=t,d.lt(this)),this.$e||this.et()}Oe(){return this.ue(),this.$e||this.et(),this.Ce}je(){return this.Ce}le(){W.we(this.Ce),super.le()}},Q=class extends E{constructor(t,e){super(t,e),this.Pe=!1,this.Ae=this.Me=Reflect.get(t,e.$),Object.defineProperty(t,e.$,Q.Ge(e.$)),this._e.renderer||this.Ut()}static Ge(t){return Q.Te[t]=Q.Te[t]||{get(){return this[l].it(t).Et()},set(e){this[l].it(t).ze(e)}}}static U(t){if(t instanceof Object)if(W.be(t)){if(!a.J(t[q])){a.U(t[q]);for(let e of t[q].ke)Q.U(e)}}else if(p.O(t,l))for(let e of t[l].rt)a.J(e)||(a.U(e),Q.U(e.Ae))}get tt(){return this.h.$.toString()}H(){this.Pe||(this.De(),this._e.renderer?this.ue():this.Ae=this.Me,this.Pe=!0)}ae(t){this._e.renderer&&super.ae(t)}De(){var t,e;null==(e=null==(t=this._e.validator)?void 0:t.apply(this.Z,[this.Me]))||e||(this.Me=void 0),this.Me=W.ge(this.Me)}Oe(){return this.Pe?(this._e.renderer&&this.ue(),this.Ae):(this.De(),this.Me)}je(){return this.Ae}ze(t){var e,s;if(this.Ct)this.Ae=t;else if(d.ct(this)&&t!==this.Me){if(null!=(s=null==(e=this._e.validator)?void 0:e.apply(this.Z,[t]))&&!s)return C.S.hook.write(this.ht);if(this.Me=W.ge(t),this._e.renderer){this.re();try{this.he(this.ne())}finally{this.oe()}}else this.lt(this.Me)}}re(){a.G({B:!0,L:new Set}),Q.U(this.Me)}get ne(){return this._e.renderer.bind(this.Z,this.Me)}he(t){t!==this.Ae&&this.lt(W.ge(t))}oe(){a.F()}lt(t){this.Ae=t,d.lt(this)}le(){W.we(this.Me),W.we(this.Ae),delete this.Me,delete this._e,super.le()}},U=Q;U.Te={};var X=class extends E{constructor(t,e){super(t,e),this._=e.v}get Se(){return{active:!0}}get ne(){return this._.bind(this.Z)}Oe(){return()=>(this.ue(),this.qe)}je(){return()=>this.qe}he(t){this.qe=t,d.lt(this)}le(){W.we(this.qe),super.le()}},Y=class extends W{constructor(t){for(let e in t)t[e]=W.ge(t[e]);super(t,Y.xe)}get ke(){let t=[];for(let e of this.ye)"object"==typeof e&&t.push(e);return this.ye}},Z=Y;Z.xe=new class extends H{get(t,e,s){return("length"==e||"symbol"==typeof e||"number"==typeof e||"string"==typeof e&&e.match(/^\d+$/))&&D.jt(t[q]),Reflect.get(t,e,s)}},"undefined"!=typeof window&&window.Vue&&(C.S.hook=new g);var tt=o.R,et=l,st=C.xt,it=k.et,rt=O.H,nt={default:$,vue:g},ht=C.S,ot=s,ct={trigger(t,e){if(t instanceof Object)if(p.O(t,l)){let s=t[l].it(e);s?D.Yt(s):console.log("Member not found")}else t instanceof D&&D.Yt(t)}};return e})()}));
//# sourceMappingURL=shrewd.min.js.map
