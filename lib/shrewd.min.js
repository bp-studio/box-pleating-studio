/**
 * shrewd v0.0.13
 * (c) 2019-2021 Mu-Tsun Tsai
 * Released under the MIT License.
 */
!function(t,e){"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?module.exports=e():t.Shrewd=e()}(this,(function(){"use strict";var t;!function(t){t.array=function(t,e){if(!t!=!e)return!1;if(t==e)return!0;if(t.length!=e.length)return!1;for(let s=0;s<t.length;s++)if(t[s]!==e[s])return!1;return!0},t.unorderedArray=function(t,e){if(!t!=!e)return!1;if(t==e)return!0;if(t.length!=e.length)return!1;for(let s of t)if(!e.includes(s))return!1;return!0}}(t||(t={}));class e{constructor(){this.t=new Set,this.i=e.h++}static o(t){return!(!G.u&&t.l)||(G.$&&!G.g(t)?(console.warn("Inside a renderer function, only the objects owned by the ObservableProperty can be written."),r.p.debug,!1):!(!G.$&&G.m)||(console.warn("Writing into Observables is not allowed inside a ComputedProperty or a ReactiveMethod. For self-correcting behavior, use the renderer option of the ObservableProperty."),r.p.debug,!1))}static v(t){r.p.hook.write(t.i);for(let e of t.t)r.p.debug?e._(t):e._()}S(t){this.t.add(t)}j(t){this.t.delete(t)}get l(){return this.t.size>0}get O(){return this.t.values()}}e.h=0;class s{read(t){return!1}write(t){}gc(){return[]}sub(t){return!1}}class i{constructor(t){if(this.k=new Set,this.R=new Set,this.C=t||"undefined"!=typeof window&&window.Vue,!this.C)throw new Error("Global Vue not found; you need to pass a Vue constructor to VueHook.");this.P=new this.C({data:{shrewd:{}}})}read(t){let e=this.P.shrewd[t];return G.m||e||(this.C.set(this.P.shrewd,t,{}),e=this.P.shrewd[t]),e&&e.__ob__.dep.subs.length>0}write(t){r.p.autoCommit||G.m?this.C.set(this.P.shrewd,t,{}):this.k.add(t)}precommit(){for(let t of this.k)this.C.set(this.P.shrewd,t,{});this.k.clear()}gc(){let t=[];for(let e in this.P.shrewd){let s=Number(e);r.p.autoCommit||this.R.has(s)?0==this.P.shrewd[e].__ob__.dep.subs.length&&(r.p.autoCommit||this.R.delete(s),this.C.delete(this.P.shrewd,e),t.push(Number(e))):this.R.add(s)}return t}sub(t){return t in this.P.shrewd&&this.P.shrewd[t].__ob__.dep.subs.length>0}}class r{static A(){r.p.hook.precommit&&r.p.hook.precommit(),A.M(),l.M(),r.p.debug&&d.G(),M.M(),r.p.hook.postcommit&&r.p.hook.postcommit()}}r.p={hook:new s,autoCommit:!0,debug:!1};class n{static get(t){if(c.T(t,T))return t[T];{let e=[];return c.D(t,T,e),e}}static q(t,e,s,i){if(void 0===e)return"function"==typeof t?n.V(t):(e,s,i)=>n.q(e,s,i,t);if("string"==typeof e){let r=s||Object.getOwnPropertyDescriptor(t,e);if(!r)return n.W(R,t,e,void 0,i);if(r.get&&!r.set)return n.W(k,t,e,r,i);if("function"==typeof r.value)return n.W(C,t,e,r,i)}console.warn(`Setup error at ${t.constructor.name}[${e.toString()}]. Decorated member must be one of the following: a field, a readonly get accessor, or a method.`),r.p.debug}static V(t){var e=new Proxy(t,n.H);return n.F.add(e),e}static W(t,e,s,i,r){var h=new t(e,s,i,r);return n.get(e).push(h.K),h.N()}}n.F=new WeakSet,n.H={construct(t,e,s){n.F.has(s)||console.warn(`Class [${s.name}] is derived form @shrewd class [${t.name}], but it is not decorated with @shrewd.`),G.I({u:!0,m:!1,B:null}),d.J.push(`construct ${t.name}`);try{let i=Reflect.construct(t,e,s);return i.constructor==t&&new o(i),n.L.has(i)&&(n.L.delete(i),u.U(i)),i}finally{d.J.pop(),G.X()}}},n.L=new Set;const h=Symbol("ShrewdObject");class o{constructor(t){this.Y=!1,this.Z=new Map,this.tt=c.D(t,h,this);let e=Object.getPrototypeOf(this.tt);for(;e;){if(c.T(e,T)){let t=e[T];for(let e of t){let t=new e.et(this.tt,e);this.Z.has(t.st)?t.it():this.Z.set(t.st,t)}}e=Object.getPrototypeOf(e)}for(let t of this.Z.values())u.rt(t)}it(){if(!this.Y){for(let t of this.Z.values())t.it();delete this.tt,this.Y=!0}}nt(t){return t?this.Z.get(t):this.Z.values()}get ht(){let t=[];for(let e of this.Z.values())e instanceof _&&t.push(e);return t}}class c{static T(t,e){return Object.prototype.hasOwnProperty.call(t,e)}static D(t,e,s){return Object.defineProperty(t,e,{enumerable:!1,writable:!1,configurable:!1,value:s}),t}}class a{get(t,e,s){let i=t[$],r=Reflect.get(t,e);return"function"==typeof r&&(r=this.ot.bind({ct:e,B:t,at:r.bind(t),ut:i,lt:s})),"size"==e&&d.ft(t[$]),r}ot(...t){switch(this.ct){case"clear":return void(d.o(this.ut)&&this.B.size>0&&(this.B.clear(),e.v(this.ut)));case"delete":return void(d.o(this.ut)&&this.B.has(t[0])&&(this.B.delete(t[0]),e.v(this.ut)));case Symbol.iterator:case"entries":case"forEach":case"has":case"keys":case"values":d.ft(this.ut);default:return this.at(...t)}}}class u{static rt(t){u.k.add(t)}static M(){if(!u.dt){u.dt=!0;for(let t of u.k)u.k.delete(t),t.U();u.dt=!1}}static U(t){if(t[h]){if(!u.dt){u.dt=!0;for(let e of t[h].nt())u.k.delete(e),e.U();u.dt=!1}}else n.L.add(t)}}u.k=new Set,u.dt=!1;class l{static M(){for(let t of l.k)t.it();l.k.clear()}static it(t,e=!1){if(t instanceof Object&&c.T(t,h)){let s=t[h];e?l.k.add(s):s.it()}}}var f;l.k=new Set,function(t){t[t.$t=0]="$outdated",t[t.gt=1]="$updated",t[t.bt=2]="$pending"}(f||(f={}));class d extends e{constructor(t){super(),this.wt=new Set,this.yt=!1,this.vt=f.$t,this.Y=!1,this.trigger=new Set,d._t.set(this.i,this),this.St=t}static jt(){for(let t of d.Ot)t.vt==f.bt&&t.xt&&(t.kt(),d.Ot.delete(t))}static G(){for(let t of d.Rt)t.trigger.clear();d.Rt.clear()}static Ct(t){let e=[t.St];for(;t.trigger.size;){let s=t.trigger.values().next().value;if(!(s instanceof d))break;let i=s.St;s instanceof p&&(i+="("+p.Pt(s)+")"),e.push(i),t=s}console.log(e)}static ft(t){if(t instanceof d&&t.Y)return;r.p.hook.read(t.i)&&t instanceof d&&t.At();let e=G.B;e&&e!=t&&!e.Y&&e.wt.add(t)}static Mt(t){if(M.Gt(t)&&!t.Y&&!(t.Tt=t.Dt()))for(let e of t.wt)e instanceof d&&d.Mt(e)}static qt(t,e=!1){t.zt(e)}get Vt(){return!!this.yt}zt(t){if(!t||(this.Wt(),!this.Y)){G.I({u:!1,B:this}),this.yt=!0,A.Et(this);try{let t=new Set(this.wt);this.Ht(),this.Ft();try{let t=this.Kt();this.Nt(t)}finally{this.It()}if(this.kt(),!this.Y)for(let e of this.wt)t.delete(e),e.S(this),this.xt&&e instanceof d&&e.At();for(let e of t)M.rt(e)}finally{this.yt=!1,G.X()}}}_(t){this.Bt(),this.Jt(t),this.xt&&A.rt(this)}it(){this.Y||(A.Et(this),d._t.delete(this.i),d.Ot.delete(this),this.Lt(),this.Ht())}get Qt(){return this.Y}Lt(){this.Y=!0,this.kt(),this.yt=!1}Ut(){for(let t of this.O)t.wt.delete(this),this.j(t)}Bt(){if(this.vt==f.gt){this.vt=f.bt,d.Ot.add(this);for(let t of this.O)t.Bt()}}Xt(){if(this.yt&&this.Yt(),this.vt!=f.gt){d.J.push(this);try{this.Wt(),this.vt==f.$t?d.qt(this):(d.Ot.delete(this),this.kt())}finally{d.J.pop()}}}Wt(){for(let t of this.wt)if(t instanceof d){if(t.yt){d.qt(this);break}t.vt!=f.gt&&t.Xt()}}Yt(){r.p.debug;let t=d.J.indexOf(this),e=[this,...d.J.slice(t+1)];e.forEach((t=>t instanceof d&&t.it())),e.push(this);let s=e.map((t=>"string"==typeof t?t:t.St)).join(" => ");console.warn("Cyclic dependency detected: "+s+"\nAll these reactions will be terminated.")}kt(){this.vt=f.gt}Jt(t){t&&(d.Rt.add(this),this.trigger.add(t)),this.vt=f.$t}get Zt(){return this.vt}get xt(){return this.Tt=null!=this.Tt?this.Tt:this.Dt()}Dt(){if(r.p.hook.sub(this.i))return!0;for(let t of this.O)if(t.xt)return!0;return!1}At(){if(!this.xt){this.Tt=!0;for(let t of this.wt)t instanceof d&&t.At()}}Ft(){}Nt(t){}It(){}Ht(){for(let t of this.wt)t.j(this);this.wt.clear()}get te(){return this.wt.size>0}get ee(){return this.Y}}d.Ot=new Set,d.Rt=new Set,d._t=new Map,d.J=[];const $=Symbol("Observable Helper");class g extends e{constructor(t,e){super(),this.se=c.D(t,$,this),this.ie=new Proxy(t,e),g.re.set(t,this.ie)}static ne(t){if(!(t instanceof Object))return t;if(g.re.has(t))return g.re.get(t);if(!g.he(t))switch(Object.getPrototypeOf(t)){case Array.prototype:t=new j(t).oe;break;case Set.prototype:t=new m(t).oe;break;case Map.prototype:t=new y(t).oe;break;case Object.prototype:t=new w(t).oe}return t}static ce(t){g.he(t)&&(t=t[$].se),t instanceof Object&&g.re.has(t)&&g.re.delete(t)}static he(t){return t instanceof Object&&c.T(t,$)}get oe(){return this.ie}}g.re=new WeakMap;class p extends d{constructor(t,e){super(e.ae+"."+e.ue.toString()),this.le=e,this.fe=Object.assign(this.de,e.p),this.tt=t}static Pt(t){return t.tt.constructor.name}get st(){return this.le.ae+"."+this.le.ue.toString()}U(){this.Xt()}get de(){return{}}Dt(){return!!this.fe.active||super.Dt()}$e(){return this.ee?this.ge():(d.ft(this),this.pe())}}class b{has(t,e){return d.ft(t[$]),Reflect.has(t,e)}get(t,e,s){return d.ft(t[$]),Reflect.get(t,e,s)}set(t,s,i,r){let n=t[$];if(e.o(n)){return i!==Reflect.get(t,s,r)&&(Reflect.set(t,s,g.ne(i),r),e.v(n)),!0}return!0}deleteProperty(t,s){let i=t[$];if(e.o(i)){let r=Reflect.deleteProperty(t,s);return r&&e.v(i),r}return!0}}class w extends g{constructor(t){for(let e in t)t[e]=g.ne(t[e]);super(t,w.be)}get we(){let t=[];for(let e in this.se){let s=this.se[e];"object"==typeof s&&t.push(s)}return t}}w.be=new b;class m extends g{constructor(t){for(let e of t)t.delete(e),t.add(g.ne(e));super(t,m.be)}get we(){let t=[];for(let e of this.se)"object"==typeof e&&t.push(e);return t}}m.be=new class extends a{ot(...t){return"add"==this.ct?(d.o(this.ut)&&!this.B.has(t[0])&&(this.B.add(g.ne(t[0])),e.v(this.ut)),this.lt):super.ot.apply(this,t)}};class y extends g{constructor(t){for(let[e,s]of t)t.set(e,g.ne(s));super(t,y.be)}get we(){let t=[];for(let[e,s]of this.se)"object"==typeof e&&t.push(e),"object"==typeof s&&t.push(s);return t}}y.be=new class extends a{ot(...t){return"set"==this.ct?(d.o(this.ut)&&!this.B.has(t[0])&&(this.B.set(t[0],g.ne(t[1])),e.v(this.ut)),this.lt):super.ot.apply(this,t)}};class v extends p{constructor(t,e){var s,i;super(t,e),this.me=e.at,this.fe.active&&this._(),null!==(s=(i=this.fe).comparer)&&void 0!==s||(i.comparer=(t,e)=>t===e)}get Kt(){return this.me.bind(this.tt)}Nt(t){this.fe.comparer.apply(this.tt,[this.ye,t,this])||(this.ye=t,e.v(this)),this.te||this.it()}pe(){return this.Xt(),this.te||this.it(),this.ye}ge(){return this.ye}Lt(){g.ce(this.ye),super.Lt()}}class _ extends p{constructor(t,e){super(t,e),this.ve=!1,this._e=this.Se=Reflect.get(t,e.ue),Object.defineProperty(t,e.ue,_.je(e.ue)),this.fe.renderer||this.kt()}static je(t){return _.Oe[t]=_.Oe[t]||{get(){return this[h].nt(t).$e()},set(e){this[h].nt(t).xe(e)}}}static ke(t){if(t instanceof Object)if(g.he(t)){if(!G.g(t[$])){G.ke(t[$]);for(let e of t[$].we)_.ke(e)}}else if(c.T(t,h))for(let e of t[h].ht)G.g(e)||(G.ke(e),_.ke(e._e))}get st(){return this.le.ue.toString()}U(){this.ve||(this.Re(),this.fe.renderer?this.Xt():this._e=this.Se,this.ve=!0)}Jt(t){this.fe.renderer&&super.Jt(t)}Re(){var t,e;null===(e=null===(t=this.fe.validator)||void 0===t?void 0:t.apply(this.tt,[this.Se]))||void 0===e||e||(this.Se=void 0),this.Se=g.ne(this.Se)}pe(){return this.ve?(this.fe.renderer&&this.Xt(),this._e):(this.Re(),this.Se)}ge(){return this._e}xe(t){var s,i;if(this.ee)this._e=t;else if(e.o(this)&&t!==this.Se){if(null!==(i=null===(s=this.fe.validator)||void 0===s?void 0:s.apply(this.tt,[t]))&&void 0!==i&&!i)return r.p.hook.write(this.i);if(this.Se=g.ne(t),this.fe.renderer){this.Ft();try{this.Nt(this.Kt())}finally{this.It()}}else this.v(this.Se)}}Ft(){G.I({$:!0,Ce:new Set}),_.ke(this.Se)}get Kt(){return this.fe.renderer.bind(this.tt,this.Se)}Nt(t){t!==this._e&&this.v(g.ne(t))}It(){G.X()}v(t){this._e=t,e.v(this)}Lt(){g.ce(this.Se),g.ce(this._e),delete this.Se,delete this.fe,super.Lt()}}_.Oe={};class S extends p{constructor(t,e){super(t,e),this.ot=e.at}get de(){return{active:!0}}get Kt(){return this.ot.bind(this.tt)}pe(){return()=>(this.Xt(),this.Pe)}ge(){return()=>this.Pe}Nt(t){this.Pe=t,e.v(this)}Lt(){g.ce(this.Pe),super.Lt()}}class j extends g{constructor(t){for(let e in t)t[e]=g.ne(t[e]);super(t,j.be)}get we(){let t=[];for(let e of this.se)"object"==typeof e&&t.push(e);return this.se}}var O;j.be=new class extends b{get(t,e,s){return("length"==e||"symbol"==typeof e||"number"==typeof e||"string"==typeof e&&e.match(/^\d+$/))&&d.ft(t[$]),Reflect.get(t,e,s)}},function(e){e.shrewd=n.q,e.symbol=h,e.commit=r.A,e.terminate=l.it,e.initialize=u.U,e.hook={default:s,vue:i},e.option=r.p,e.comparer=t,e.debug={trigger(t,e){if(t instanceof Object)if(c.T(t,h)){let s=t[h].nt(e);s?d.Ct(s):console.log("Member not found")}else t instanceof d&&d.Ct(t)}}}(O||(O={})),"undefined"!=typeof window&&window.Vue&&(r.p.hook=new i);class x{constructor(t,e,s,i){this.Ae=t,this.Me=e,this.le=s,this.Ge=i}get St(){return this.Ae.constructor.name+"."+this.Me.toString()}get K(){return{ue:this.Me.toString(),ae:this.Ae.constructor.name,et:this.Te,at:this.ot,p:this.Ge}}get ot(){}N(){}}class k extends x{get Te(){return v}get ot(){return this.le.get}N(){let t=this.St,e=this.ot;return this.le.get=function(){if(c.T(this,h)){return this[h].nt(t).$e()}return e.apply(this)},this.le}}class R extends x{get Te(){return _}}class C extends x{get Te(){return S}get ot(){return this.le.value}N(){let t=this.St,e=this.ot;return delete this.le.value,delete this.le.writable,this.le.get=function(){if(c.T(this,h)){return this[h].nt(t).$e()}return e.bind(this)},this.le}}class P{static De(){r.A(),P.qe=!1}static N(){r.p.autoCommit&&!P.qe&&(P.qe=!0,Promise.resolve().then(P.De))}}P.qe=!1;class A{static M(){for(G.I({m:!0});A.k.size>0;)for(let t of A.k)d.qt(t,!0);d.jt(),G.X()}static Et(t){A.k.delete(t)}static rt(t){t.Vt||A.k.add(t),P.N()}}A.k=new Set;class M{static rt(t){t instanceof d&&M.k.add(t)}static M(){for(let t of M.k)d.Mt(t);M.k.clear();for(let t of r.p.hook.gc()){let e=d._t.get(t);e&&d.Mt(e)}M.ze.clear()}static Gt(t){return!M.ze.has(t)&&(M.ze.add(t),!0)}}M.k=new Set,M.ze=new Set;class G{static I(t){G.Ve.push(G.vt),G.vt=Object.assign({},G.vt,t)}static X(){G.vt=G.Ve.pop(),0==G.Ve.length&&u.M()}static get m(){return G.vt.m}static get u(){return G.vt.u}static get $(){return G.vt.$}static get B(){return G.vt.B}static g(t){return G.vt.Ce.has(t)}static ke(t){G.vt.Ce.add(t)}}G.vt={m:!1,u:!1,$:!1,B:null,Ce:new Set},G.Ve=[];const T=Symbol("Shrewd Decorators");return O}));
